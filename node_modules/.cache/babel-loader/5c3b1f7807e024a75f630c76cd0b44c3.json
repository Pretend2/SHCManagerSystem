{"ast":null,"code":"import { createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"padding\": \"0 10px\"\n  }\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" 查询 \");\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" 重置 \");\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\" 登记 \");\n\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"访客ID\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"访客姓名/性别\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"访客联系方式\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"业主姓名\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"来访事由/类型\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"车牌号\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"创建时间\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"来访/离开时间\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"状态\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"操作\")])], -1\n/* HOISTED */\n);\n\nconst _hoisted_6 = [\"innerHTML\"];\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\"修改\");\n\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"删除\");\n\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"提交 \");\n\nconst _hoisted_11 = {\n  key: 0,\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"center\",\n    \"align-items\": \"center\",\n    \"margin-top\": \"10px\",\n    \"margin-bottom\": \"10px\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode($setup[\"NCard\"], {\n    title: \"访客信息\",\n    style: {\n      \"margin-top\": \"10px\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"NSpace\"], {\n      \"item-style\": \"display: flex; align-item: center;\"\n    }, {\n      default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n        value: $setup.findData.name,\n        \"onUpdate:value\": _cache[0] || (_cache[0] = $event => $setup.findData.name = $event),\n        type: \"text\",\n        placeholder: \"请填写来访人姓名\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode($setup[\"NInput\"], {\n        value: $setup.findData.phone,\n        \"onUpdate:value\": _cache[1] || (_cache[1] = $event => $setup.findData.phone = $event),\n        type: \"text\",\n        placeholder: \"请填写来访人联系方式\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode($setup[\"NDatePicker\"], {\n        value: $setup.findData.dataRange,\n        \"onUpdate:value\": _cache[2] || (_cache[2] = $event => $setup.findData.dataRange = $event),\n        type: \"datetimerange\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode($setup[\"NButton\"], {\n        onClick: $setup.findTouRegData,\n        type: \"primary\"\n      }, {\n        icon: _withCtx(() => [_createVNode($setup[\"NIcon\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"SearchIcon\"])]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        default: _withCtx(() => [_hoisted_2]),\n        _: 1\n        /* STABLE */\n\n      }), _createVNode($setup[\"NButton\"], {\n        onClick: $setup.resetTouReg\n      }, {\n        icon: _withCtx(() => [_createVNode($setup[\"NIcon\"], null, {\n          default: _withCtx(() => [_createVNode($setup[\"ArrowClockwiseIcon\"])]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        default: _withCtx(() => [_hoisted_3]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      _: 1\n      /* STABLE */\n\n    })]),\n    _: 1\n    /* STABLE */\n\n  }), _createVNode($setup[\"NSpin\"], {\n    show: $setup.touRegLoading\n  }, {\n    default: _withCtx(() => [_createVNode($setup[\"NCard\"], {\n      title: \"公告信息\",\n      style: {\n        \"margin-top\": \"10px\",\n        \"padding\": \"0\",\n        \"margin-bottom\": \"10px\"\n      }\n    }, {\n      \"header-extra\": _withCtx(() => [_createVNode($setup[\"NSpace\"], null, {\n        default: _withCtx(() => [_createVNode($setup[\"NButton\"], {\n          onClick: _cache[3] || (_cache[3] = $event => $setup.openTouRegModal('add')),\n          type: \"primary\"\n        }, {\n          icon: _withCtx(() => [_createVNode($setup[\"NIcon\"], null, {\n            default: _withCtx(() => [_createVNode($setup[\"AddIcon\"])]),\n            _: 1\n            /* STABLE */\n\n          })]),\n          default: _withCtx(() => [_hoisted_4]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      default: _withCtx(() => [_createVNode($setup[\"NTable\"], {\n        style: {\n          \"margin-top\": \"10px\"\n        },\n        striped: \"\"\n      }, {\n        default: _withCtx(() => [_hoisted_5, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.touRegData, (item, index) => {\n          return _openBlock(), _createElementBlock(\"tr\", {\n            key: index\n          }, [_createElementVNode(\"td\", null, [_createVNode($setup[\"NEllipsis\"], {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.visitorsNo), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, [_createVNode($setup[\"NEllipsis\"], {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.name) + \"/\" + _toDisplayString(item.gender === 1 ? '男' : '女'), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, _toDisplayString(item.phone), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, _toDisplayString(item.owner.name), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, [_createVNode($setup[\"NEllipsis\"], {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.reason) + \"(\" + _toDisplayString(item.type === 0 ? '白事' : '喜事') + \") \", 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, _toDisplayString(item.carNo), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, [_createVNode($setup[\"NEllipsis\"], {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.createTime), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, [_createVNode($setup[\"NEllipsis\"], {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.visitingTime) + \"/\" + _toDisplayString(item.leaveTime), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", {\n            innerHTML: new Date(item.leaveTime).getTime() >= new Date().getTime() ? '<span style=\\'color:green\\'>已生效</span>' : '<span style=\\'color:red\\'>已失效</span>'\n          }, null, 8\n          /* PROPS */\n          , _hoisted_6), _createElementVNode(\"td\", null, [_createVNode($setup[\"NButtonGroup\"], {\n            size: \"large\"\n          }, {\n            default: _withCtx(() => [_createVNode($setup[\"NButton\"], {\n              onClick: $event => $setup.openTouRegModal('update', item),\n              size: \"small\"\n            }, {\n              default: _withCtx(() => [_hoisted_7]),\n              _: 2\n              /* DYNAMIC */\n\n            }, 1032\n            /* PROPS, DYNAMIC_SLOTS */\n            , [\"onClick\"]), _createVNode($setup[\"NButton\"], {\n              type: \"error\",\n              size: \"small\",\n              strong: \"\",\n              secondary: \"\"\n            }, {\n              default: _withCtx(() => [_hoisted_8]),\n              _: 1\n              /* STABLE */\n\n            })]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )])]);\n        }), 128\n        /* KEYED_FRAGMENT */\n        ))])]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode($setup[\"NModal\"], {\n      \"auto-focus\": false,\n      show: $setup.showTouRegModal,\n      \"onUpdate:show\": _cache[13] || (_cache[13] = $event => $setup.showTouRegModal = $event),\n      class: \"custom-card\",\n      preset: \"card\",\n      style: {\n        \"width\": \"600px\"\n      },\n      title: \"访客登记\",\n      \"transform-origin\": \"center\",\n      size: \"huge\",\n      bordered: false,\n      segmented: {\n        content: 'soft',\n        footer: 'soft'\n      }\n    }, {\n      footer: _withCtx(() => [_createVNode($setup[\"NSpace\"], {\n        justify: \"end\"\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NButton\"], {\n          onClick: _cache[12] || (_cache[12] = $event => $setup.showTouRegModal = false)\n        }, {\n          default: _withCtx(() => [_hoisted_9]),\n          _: 1\n          /* STABLE */\n\n        }), _createVNode($setup[\"NButton\"], {\n          loading: $setup.submitTouRegLoading,\n          onClick: $setup.rouRegSubmit,\n          type: \"primary\",\n          \"attr-type\": \"button\"\n        }, {\n          default: _withCtx(() => [_hoisted_10]),\n          _: 1\n          /* STABLE */\n\n        }, 8\n        /* PROPS */\n        , [\"loading\"])]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      default: _withCtx(() => [_createVNode($setup[\"NForm\"], {\n        ref: \"touRegFormRef\",\n        \"label-placement\": \"left\",\n        \"label-width\": 80,\n        size: \"medium\",\n        model: $setup.touRegValue,\n        rules: $setup.touRegRules\n      }, {\n        default: _withCtx(() => [_createVNode($setup[\"NGrid\"], {\n          cols: \"1\"\n        }, {\n          default: _withCtx(() => [_createVNode($setup[\"NGridItem\"], null, {\n            default: _withCtx(() => [_createVNode($setup[\"NFormItem\"], {\n              label: \"访客姓名\",\n              path: \"name\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n                placeholder: \"请输入访客姓名\",\n                value: $setup.touRegValue.name,\n                \"onUpdate:value\": _cache[4] || (_cache[4] = $event => $setup.touRegValue.name = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"访客性别\",\n              path: \"gender\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NSelect\"], {\n                placeholder: \"请选择性别\",\n                value: $setup.touRegValue.gender,\n                \"onUpdate:value\": _cache[5] || (_cache[5] = $event => $setup.touRegValue.gender = $event),\n                style: {\n                  \"width\": \"180px\"\n                },\n                options: $setup.touRegGender,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\", \"options\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"联系方式\",\n              path: \"phone\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n                placeholder: \"请输入联系方式\",\n                value: $setup.touRegValue.phone,\n                \"onUpdate:value\": _cache[6] || (_cache[6] = $event => $setup.touRegValue.phone = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"车牌号\",\n              path: \"carNo\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n                placeholder: \"请输入车牌号\",\n                value: $setup.touRegValue.carNo,\n                \"onUpdate:value\": _cache[7] || (_cache[7] = $event => $setup.touRegValue.carNo = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"时间\",\n              path: \"dataRange\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NDatePicker\"], {\n                type: \"datetimerange\",\n                value: $setup.touRegValue.dataRange,\n                \"onUpdate:value\": _cache[8] || (_cache[8] = $event => $setup.touRegValue.dataRange = $event),\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"目标业主\",\n              path: \"ownerNo\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NSelect\"], {\n                filterable: \"\",\n                placeholder: \"请选择目标业主\",\n                value: $setup.touRegValue.ownerNo,\n                \"onUpdate:value\": _cache[9] || (_cache[9] = $event => $setup.touRegValue.ownerNo = $event),\n                options: $setup.targetOwnerInfo,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\", \"options\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"事由类型\",\n              path: \"type\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NSelect\"], {\n                filterable: \"\",\n                placeholder: \"请选择事由类型\",\n                value: $setup.touRegValue.type,\n                \"onUpdate:value\": _cache[10] || (_cache[10] = $event => $setup.touRegValue.type = $event),\n                options: $setup.reasonInfo,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode($setup[\"NFormItem\"], {\n              label: \"拜访事由\",\n              path: \"reason\"\n            }, {\n              default: _withCtx(() => [_createVNode($setup[\"NInput\"], {\n                placeholder: \"请输入拜访事由\",\n                value: $setup.touRegValue.reason,\n                \"onUpdate:value\": _cache[11] || (_cache[11] = $event => $setup.touRegValue.reason = $event),\n                type: \"textarea\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            })]),\n            _: 1\n            /* STABLE */\n\n          })]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"model\", \"rules\"])]),\n      _: 1\n      /* STABLE */\n\n    }, 8\n    /* PROPS */\n    , [\"show\"]), $setup.pages > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [_createVNode($setup[\"NPagination\"], {\n      \"onUpdate:page\": $setup.touRegPageChange,\n      \"page-count\": $setup.pages\n    }, null, 8\n    /* PROPS */\n    , [\"page-count\"])])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"show\"])]);\n}","map":{"version":3,"mappings":"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","names":["style","_createElementVNode","_createElementBlock","_createVNode","$setup","title","value","name","$event","type","placeholder","clearable","phone","dataRange","onClick","icon","show","_withCtx","striped","_hoisted_5","_Fragment","_renderList","item","index","key","visitorsNo","_toDisplayString","gender","owner","reason","carNo","createTime","visitingTime","leaveTime","innerHTML","Date","getTime","size","strong","secondary","class","preset","bordered","segmented","content","footer","justify","loading","ref","model","rules","cols","label","path","options","filterable","ownerNo"],"sourceRoot":"","sources":["D:\\VCode\\SHC社区管理系统\\shc_community_manager_system\\src\\layout\\office\\TouristRegistrationLayout.vue"],"sourcesContent":["<template>\r\n  <div style=\"padding: 0 10px\">\r\n    <n-card title=\"访客信息\" style=\"margin-top: 10px\">\r\n      <n-space item-style=\"display: flex; align-item: center;\">\r\n        <n-input v-model:value=\"findData.name\" type=\"text\" placeholder=\"请填写来访人姓名\" clearable />\r\n        <n-input v-model:value=\"findData.phone\" type=\"text\" placeholder=\"请填写来访人联系方式\" clearable />\r\n        <n-date-picker v-model:value=\"findData.dataRange\" type=\"datetimerange\" clearable />\r\n        <n-button @click=\"findTouRegData\" type=\"primary\">\r\n          <template #icon>\r\n            <n-icon>\r\n              <search-icon />\r\n            </n-icon>\r\n          </template>\r\n          查询\r\n        </n-button>\r\n        <n-button @click=\"resetTouReg\">\r\n          <template #icon>\r\n            <n-icon>\r\n              <arrow-clockwise-icon />\r\n            </n-icon>\r\n          </template>\r\n          重置\r\n        </n-button>\r\n      </n-space>\r\n    </n-card>\r\n\r\n    <n-spin :show=\"touRegLoading\">\r\n      <n-card title=\"公告信息\" style=\"margin-top: 10px;padding: 0; margin-bottom: 10px;\">\r\n        <template #header-extra>\r\n          <n-space>\r\n            <n-button @click=\"openTouRegModal('add')\" type=\"primary\">\r\n              <template #icon>\r\n                <n-icon>\r\n                  <add-icon />\r\n                </n-icon>\r\n              </template>\r\n              登记\r\n            </n-button>\r\n          </n-space>\r\n        </template>\r\n        <n-table style=\"margin-top: 10px\" striped>\r\n          <thead>\r\n            <tr>\r\n              <th>访客ID</th>\r\n              <th>访客姓名/性别</th>\r\n              <th>访客联系方式</th>\r\n              <th>业主姓名</th>\r\n              <th>来访事由/类型</th>\r\n              <th>车牌号</th>\r\n              <th>创建时间</th>\r\n              <th>来访/离开时间</th>\r\n              <th>状态</th>\r\n              <th>操作</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(item, index) in touRegData\" :key=\"index\">\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.visitorsNo }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.name }}/{{ item.gender === 1 ? '男' : '女' }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>{{ item.phone }}</td>\r\n              <td>{{ item.owner.name }}</td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.reason }}({{ item.type === 0 ? '白事' : '喜事' }})\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                {{ item.carNo }}\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.createTime }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.visitingTime }}/{{ item.leaveTime }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td v-html=\"new Date(item.leaveTime).getTime() >= new Date().getTime() ?\r\n              '<span style=\\'color:green\\'>已生效</span>' : '<span style=\\'color:red\\'>已失效</span>'\"></td>\r\n              <td>\r\n                <n-button-group size=\"large\">\r\n                  <n-button @click=\"openTouRegModal('update', item)\" size=\"small\">修改</n-button>\r\n                  <n-button type=\"error\" size=\"small\" strong secondary>删除</n-button>\r\n                </n-button-group>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </n-table>\r\n      </n-card>\r\n\r\n      <n-modal :auto-focus=\"false\" v-model:show=\"showTouRegModal\" class=\"custom-card\" preset=\"card\" style=\"width: 600px\"\r\n        title=\"访客登记\" transform-origin=\"center\" size=\"huge\" :bordered=\"false\"\r\n        :segmented=\"{ content: 'soft', footer: 'soft' }\">\r\n        <n-form ref=\"touRegFormRef\" label-placement=\"left\" :label-width=\"80\" size=\"medium\" :model=\"touRegValue\"\r\n          :rules=\"touRegRules\">\r\n          <n-grid cols=\"1\">\r\n            <n-grid-item>\r\n              <n-form-item label=\"访客姓名\" path=\"name\">\r\n                <n-input placeholder=\"请输入访客姓名\" v-model:value=\"touRegValue.name\" />\r\n              </n-form-item>\r\n              <n-form-item label=\"访客性别\" path=\"gender\">\r\n                <n-select placeholder=\"请选择性别\" v-model:value=\"touRegValue.gender\" style=\"width: 180px\"\r\n                  :options=\"touRegGender\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"联系方式\" path=\"phone\">\r\n                <n-input placeholder=\"请输入联系方式\" v-model:value=\"touRegValue.phone\" />\r\n              </n-form-item>\r\n              <n-form-item label=\"车牌号\" path=\"carNo\">\r\n                <n-input placeholder=\"请输入车牌号\" v-model:value=\"touRegValue.carNo\" />\r\n              </n-form-item>\r\n              <n-form-item label=\"时间\" path=\"dataRange\">\r\n                <n-date-picker type=\"datetimerange\" v-model:value=\"touRegValue.dataRange\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"目标业主\" path=\"ownerNo\">\r\n                <n-select filterable placeholder=\"请选择目标业主\" v-model:value=\"touRegValue.ownerNo\"\r\n                  :options=\"targetOwnerInfo\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"事由类型\" path=\"type\">\r\n                <n-select filterable placeholder=\"请选择事由类型\" v-model:value=\"touRegValue.type\" :options=\"reasonInfo\"\r\n                  clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"拜访事由\" path=\"reason\">\r\n                <n-input placeholder=\"请输入拜访事由\" v-model:value=\"touRegValue.reason\" type=\"textarea\" />\r\n              </n-form-item>\r\n            </n-grid-item>\r\n          </n-grid>\r\n        </n-form>\r\n        <template #footer>\r\n          <n-space justify=\"end\">\r\n            <n-button @click=\"showTouRegModal = false\">取消</n-button>\r\n            <n-button :loading=\"submitTouRegLoading\" @click=\"rouRegSubmit\" type=\"primary\" attr-type=\"button\">提交\r\n            </n-button>\r\n          </n-space>\r\n        </template>\r\n      </n-modal>\r\n\r\n      <div v-if=\"pages > 1\"\r\n        style=\"display: flex;justify-content: center;align-items: center;margin-top: 10px;margin-bottom: 10px;\">\r\n        <n-pagination @update:page=\"touRegPageChange\" :page-count=\"pages\" />\r\n      </div>\r\n    </n-spin>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\n// 引入 vue\r\nimport { ref, inject, computed } from 'vue'\r\n// 引入 naive-ui 组件\r\nimport {\r\n  NCard, NSpace, NInput, NButton, NTable,\r\n  NIcon, NPagination, NButtonGroup, NGrid,\r\n  NEllipsis, NSelect, NDatePicker, useMessage,\r\n  useDialog, NSpin, NForm, NFormItem, NModal,\r\n  NGridItem\r\n} from 'naive-ui'\r\n// 引入图标 \r\nimport {\r\n  Add16Regular as AddIcon,\r\n  Edit16Regular as EditIcon,\r\n  Delete16Regular as DeleteIcon,\r\n  Search16Regular as SearchIcon,\r\n  ArrowClockwise16Regular as ArrowClockwiseIcon,\r\n  CaretDown12Filled as CaretDownIcon,\r\n} from '@vicons/fluent'\r\n\r\nimport axios from 'axios'\r\n\r\nimport { formatDate, mergeObject, createId } from '../../util/BaseUtil'\r\nimport QueryString from 'qs'\r\n\r\nconst global = inject('global')\r\n\r\n// 获取消息对象\r\nconst message = useMessage()\r\n// 获取弹框对象\r\nconst dialog = useDialog()\r\n\r\n// #region 数据查询\r\nconst findData = ref({\r\n  name: null,\r\n  phone: null,\r\n  dataRange: null,\r\n  visitingTime: computed(() => {\r\n    if (findData.value.dataRange != null) {\r\n      return formatDate(new Date(findData.value.dataRange[0]))\r\n    }\r\n    return null\r\n  }),\r\n  leaveTime: computed(() => {\r\n    if (findData.value.dataRange != null) {\r\n      return formatDate(new Date(findData.value.dataRange[1]))\r\n    }\r\n    return null\r\n  })\r\n})\r\n\r\n/**\r\n * 查询访客登记信息\r\n */\r\nconst findTouRegData = () => {\r\n  touRegPageChange(1)\r\n}\r\n\r\n/**\r\n * 重置查询数据\r\n */\r\nconst resetTouReg = () => {\r\n  findData.value.name = null\r\n  findData.value.phone = null\r\n  findData.value.dataRange = null\r\n}\r\n// #endregion\r\n\r\n// #region 加载访客登记信息\r\nconst touRegData = ref([]) // 访客登记信息数据\r\nconst pageNo = ref(1) // 当前页码\r\nconst pages = ref(1) // 总页数\r\nconst touRegLoading = ref(false) // 加载中\r\n/**\r\n * 加载访客登记信息\r\n */\r\nconst loadTouRegData = (more) => {\r\n  const params = {\r\n    page: 1,\r\n    size: global.pageSize\r\n  }\r\n  mergeObject(params, more, ['dataRange'])\r\n  touRegLoading.value = true\r\n  axios({\r\n    method: 'get',\r\n    url: global.api + '/getAllVisitorRecords',\r\n    params\r\n  }).then(res => {\r\n    pageNo.value = res.data.pageNo // 设置当前页码\r\n    pages.value = res.data.pages // 设置总页数\r\n    touRegData.value = res.data.list // 设置访客登记数据\r\n  }).catch(err => {\r\n    message.error('加载访客信息出现异常！' + err)\r\n  }).finally(() => {\r\n    touRegLoading.value = false\r\n  })\r\n}\r\nloadTouRegData()\r\n\r\n/**\r\n * 页码发生变化时触发\r\n * @param {页码} page \r\n */\r\nconst touRegPageChange = (page) => {\r\n  const more = {\r\n    page,\r\n  }\r\n  mergeObject(more, findData.value)\r\n  loadTouRegData(more)\r\n}\r\n\r\n// #endregion\r\n\r\n// #region 访客模态框\r\n\r\nconst showTouRegModal = ref(false) // 显示模态框\r\nconst touRegModalModel = ref(null) // 模态框模式\r\nconst touRegFormRef = ref(null) // form 表单的引用\r\nconst submitTouRegLoading = ref(false) // 提交按钮加载\r\nlet selectItem = null // 当前选中的访客信息\r\n\r\n// 性别数据\r\nconst touRegGender = ['女', '男'].map((k, v) => ({\r\n  label: k,\r\n  value: v\r\n}))\r\n\r\n/**\r\n * 访客数据\r\n */\r\nconst touRegValue = ref({\r\n  name: null,\r\n  gender: null,\r\n  phone: null,\r\n  carNo: null,\r\n  dataRange: null,\r\n  visitingTime: computed(() => {\r\n    if (touRegValue.value.dataRange != null) {\r\n      return formatDate(new Date(touRegValue.value.dataRange[0]))\r\n    }\r\n    return null\r\n  }),\r\n  leaveTime: computed(() => {\r\n    if (touRegValue.value.dataRange != null) {\r\n      return formatDate(new Date(touRegValue.value.dataRange[1]))\r\n    }\r\n    return null\r\n  }),\r\n  ownerNo: null,\r\n  type: null,\r\n  reason: null\r\n})\r\n\r\n/**\r\n * 访客数据校验\r\n */\r\nconst touRegRules = ref({\r\n  name: {\r\n    required: true,\r\n    message: \"请输入访客姓名\",\r\n    trigger: \"blur\"\r\n  },\r\n  gender: {\r\n    required: true,\r\n    type: 'number',\r\n    message: '请选择性别',\r\n    trigger: 'blur'\r\n  },\r\n  phone: {\r\n    required: true,\r\n    message: '请输入联系方式',\r\n    trigger: 'blur'\r\n  },\r\n  dataRange: {\r\n    required: true,\r\n    type: 'array',\r\n    message: '请选择时间',\r\n    trigger: 'blur'\r\n  },\r\n  ownerNo: {\r\n    required: true,\r\n    message: '请选择目标业主',\r\n    trigger: 'blur'\r\n  },\r\n  type: {\r\n    required: true,\r\n    type: 'number',\r\n    message: '请选择事由类型',\r\n    trigger: 'blur'\r\n  },\r\n  reason: {\r\n    required: true,\r\n    message: '请输入拜访事由',\r\n    trigger: 'blur'\r\n  }\r\n})\r\n\r\n/**\r\n * 打开模态框\r\n */\r\nconst openTouRegModal = (model, item) => {\r\n  // 重置访客信息\r\n  touRegValue.value = {\r\n    name: null,\r\n    gender: null,\r\n    phone: null,\r\n    carNo: null,\r\n    dataRange: null,\r\n    ownerNo: null,\r\n    type: null,\r\n    reason: null\r\n  }\r\n\r\n  if (model === 'add') {\r\n\r\n  } else if (model === 'update') {\r\n    // 填充访客信息\r\n    touRegValue.value = {\r\n      name: item.name,\r\n      gender: item.gender,\r\n      phone: item.phone,\r\n      carNo: item.carNo,\r\n      dataRange: [\r\n        new Date(item.visitingTime).getTime(),\r\n        new Date(item.leaveTime).getTime()\r\n      ],\r\n      ownerNo: item.ownerNo,\r\n      type: item.type,\r\n      reason: item.reason\r\n    }\r\n    selectItem = item\r\n  }\r\n\r\n  touRegModalModel.value = model\r\n  showTouRegModal.value = true\r\n}\r\n\r\n/**\r\n * 提交按钮\r\n */\r\nconst rouRegSubmit = (e) => {\r\n  e.preventDefault();\r\n  touRegFormRef.value?.validate((errors) => {\r\n    if (!errors) {\r\n      // 校验通过\r\n      if (touRegModalModel.value === 'add') {\r\n        addTouReg()\r\n      } else if (touRegModalModel.value === 'update') {\r\n        updateTouReg()\r\n      }\r\n    } else {\r\n      // 校验不通过\r\n    }\r\n  });\r\n}\r\n\r\n// 添加访客信息\r\nconst addTouReg = () => {\r\n  touRegValue.value.visitorsNo = createId()\r\n  submitTouRegLoading.value = true\r\n  axios({\r\n    method: 'post',\r\n    url: global.api + '/addVisitorRecords',\r\n    data: QueryString.stringify(touRegValue.value)\r\n  }).then(res => {\r\n    if (res.data.success) {\r\n      message.success('访客添加成功！')\r\n      // 刷新列表\r\n      touRegPageChange(pageNo.value)\r\n      showTouRegModal.value = false\r\n    } else {\r\n      message.warning('访客添加失败！')\r\n    }\r\n  }).catch(err => {\r\n    message.error('添加访客信息异常！' + err)\r\n  }).finally(() => {\r\n    submitTouRegLoading.value = false\r\n  })\r\n}\r\n\r\n/**\r\n * 修改访客信息\r\n */\r\nconst updateTouReg = () => {\r\n  touRegValue.value.visitorsNo = selectItem.visitorsNo\r\n  submitTouRegLoading.value = true\r\n  axios({\r\n    method: 'put',\r\n    url: global.api + '/updateVisitorRecords',\r\n    data: QueryString.stringify(touRegValue.value)\r\n  }).then(res => {\r\n    if (res.data.success) {\r\n      message.success('访客修改成功！')\r\n      // 刷新列表\r\n      touRegPageChange(pageNo.value)\r\n      showTouRegModal.value = false\r\n    } else {\r\n      message.warning('访客修改失败！')\r\n    }\r\n  }).catch(err => {\r\n    message.error('修改访客信息异常！' + err)\r\n  }).finally(() => {\r\n    submitTouRegLoading.value = false\r\n  })\r\n}\r\n\r\n// 事由数据\r\nconst reasonInfo = [\r\n  {\r\n    label: '喜事',\r\n    value: 1\r\n  },\r\n  {\r\n    label: '白事',\r\n    value: 0\r\n  }\r\n]\r\n// 目标业主信息\r\nconst targetOwnerInfo = ref([])\r\n// 目标业主加载中\r\nconst targetOwnerInfoLoading = ref(true)\r\n// 加载目标业主信息\r\naxios({\r\n  method: 'get',\r\n  url: global.api + 'getAllOwnerNoPaging',\r\n}).then(res => {\r\n  for (let owner of res.data) {\r\n    owner.label = owner.ownerNo + \" - \" + owner.name\r\n    owner.value = owner.ownerNo\r\n    targetOwnerInfo.value.push(owner)\r\n  }\r\n}).catch(err => {\r\n  message.error('目标业主信息加载异常！' + err)\r\n}).finally(() => {\r\n  targetOwnerInfoLoading.value = false\r\n})\r\n\r\n// #endregion\r\n\r\n</script>\r\n<script>\r\nexport default {\r\n  name: 'TouristRegistrationLayout'\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}