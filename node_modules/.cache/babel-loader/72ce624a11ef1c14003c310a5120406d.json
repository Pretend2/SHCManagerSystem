{"ast":null,"code":"import { defineComponent, h, ref, provide, getCurrentInstance } from 'vue';\nimport { createId } from 'seemly';\nimport { createInjectionKey } from '../../_utils';\nimport { useConfig } from '../../_mixins';\nimport NImagePreview from './ImagePreview';\nimport { imagePreviewSharedProps } from './interface';\nexport const imageGroupInjectionKey = createInjectionKey('n-image-group');\nexport const imageGroupProps = imagePreviewSharedProps;\nexport default defineComponent({\n  name: 'ImageGroup',\n  props: imageGroupProps,\n\n  setup(props) {\n    let currentSrc;\n    const {\n      mergedClsPrefixRef\n    } = useConfig(props);\n    const groupId = `c${createId()}`;\n    const vm = getCurrentInstance();\n\n    const setPreviewSrc = src => {\n      var _a;\n\n      currentSrc = src;\n      (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setPreviewSrc(src);\n    };\n\n    function go(step) {\n      if (!(vm === null || vm === void 0 ? void 0 : vm.proxy)) return;\n      const container = vm.proxy.$el.parentElement; // use dom api since we can't get the correct order before all children are rendered\n\n      const imgs = container.querySelectorAll(`[data-group-id=${groupId}]:not([data-error=true])`);\n      if (!imgs.length) return;\n      const index = Array.from(imgs).findIndex(img => img.dataset.previewSrc === currentSrc);\n\n      if (~index) {\n        setPreviewSrc(imgs[(index + step + imgs.length) % imgs.length].dataset.previewSrc);\n      } else {\n        setPreviewSrc(imgs[0].dataset.previewSrc);\n      }\n    }\n\n    provide(imageGroupInjectionKey, {\n      mergedClsPrefixRef,\n      setPreviewSrc,\n      setThumbnailEl: el => {\n        var _a;\n\n        (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setThumbnailEl(el);\n      },\n      toggleShow: () => {\n        var _a;\n\n        (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.toggleShow();\n      },\n      groupId\n    });\n    const previewInstRef = ref(null);\n    return {\n      mergedClsPrefix: mergedClsPrefixRef,\n      previewInstRef,\n      next: () => go(1),\n      prev: () => go(-1)\n    };\n  },\n\n  render() {\n    return h(NImagePreview, {\n      theme: this.theme,\n      themeOverrides: this.themeOverrides,\n      clsPrefix: this.mergedClsPrefix,\n      ref: \"previewInstRef\",\n      onPrev: this.prev,\n      onNext: this.next,\n      showToolbar: this.showToolbar,\n      showToolbarTooltip: this.showToolbarTooltip\n    }, this.$slots);\n  }\n\n});","map":{"version":3,"names":["defineComponent","h","ref","provide","getCurrentInstance","createId","createInjectionKey","useConfig","NImagePreview","imagePreviewSharedProps","imageGroupInjectionKey","imageGroupProps","name","props","setup","currentSrc","mergedClsPrefixRef","groupId","vm","setPreviewSrc","src","_a","previewInstRef","value","go","step","proxy","container","$el","parentElement","imgs","querySelectorAll","length","index","Array","from","findIndex","img","dataset","previewSrc","setThumbnailEl","el","toggleShow","mergedClsPrefix","next","prev","render","theme","themeOverrides","clsPrefix","onPrev","onNext","showToolbar","showToolbarTooltip","$slots"],"sources":["E:/VCode/SHC社区管理系统/shc_community_manager_system/node_modules/naive-ui/es/image/src/ImageGroup.js"],"sourcesContent":["import { defineComponent, h, ref, provide, getCurrentInstance } from 'vue';\nimport { createId } from 'seemly';\nimport { createInjectionKey } from '../../_utils';\nimport { useConfig } from '../../_mixins';\nimport NImagePreview from './ImagePreview';\nimport { imagePreviewSharedProps } from './interface';\nexport const imageGroupInjectionKey = createInjectionKey('n-image-group');\nexport const imageGroupProps = imagePreviewSharedProps;\nexport default defineComponent({\n    name: 'ImageGroup',\n    props: imageGroupProps,\n    setup(props) {\n        let currentSrc;\n        const { mergedClsPrefixRef } = useConfig(props);\n        const groupId = `c${createId()}`;\n        const vm = getCurrentInstance();\n        const setPreviewSrc = (src) => {\n            var _a;\n            currentSrc = src;\n            (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setPreviewSrc(src);\n        };\n        function go(step) {\n            if (!(vm === null || vm === void 0 ? void 0 : vm.proxy))\n                return;\n            const container = vm.proxy.$el.parentElement;\n            // use dom api since we can't get the correct order before all children are rendered\n            const imgs = container.querySelectorAll(`[data-group-id=${groupId}]:not([data-error=true])`);\n            if (!imgs.length)\n                return;\n            const index = Array.from(imgs).findIndex((img) => img.dataset.previewSrc === currentSrc);\n            if (~index) {\n                setPreviewSrc(imgs[(index + step + imgs.length) % imgs.length].dataset.previewSrc);\n            }\n            else {\n                setPreviewSrc(imgs[0].dataset.previewSrc);\n            }\n        }\n        provide(imageGroupInjectionKey, {\n            mergedClsPrefixRef,\n            setPreviewSrc,\n            setThumbnailEl: (el) => {\n                var _a;\n                (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setThumbnailEl(el);\n            },\n            toggleShow: () => {\n                var _a;\n                (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.toggleShow();\n            },\n            groupId\n        });\n        const previewInstRef = ref(null);\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            previewInstRef,\n            next: () => go(1),\n            prev: () => go(-1)\n        };\n    },\n    render() {\n        return (h(NImagePreview, { theme: this.theme, themeOverrides: this.themeOverrides, clsPrefix: this.mergedClsPrefix, ref: \"previewInstRef\", onPrev: this.prev, onNext: this.next, showToolbar: this.showToolbar, showToolbarTooltip: this.showToolbarTooltip }, this.$slots));\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}