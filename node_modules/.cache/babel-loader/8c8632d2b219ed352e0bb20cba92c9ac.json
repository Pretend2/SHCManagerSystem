{"ast":null,"code":"// 添加业主\nimport { ref, inject } from 'vue';\nimport { useMessage } from 'naive-ui';\nimport QueryString from 'qs';\nimport axios from 'axios';\nimport { createId } from '../../../util/BaseUtil';\nexport default (refreshOwnerData => {\n  // 接收全局变量\n  const global = inject(\"global\"); // 获取消息对象\n\n  const message = useMessage(); // 业主 模态框\n\n  const ownerStatus = ref(false); // false 添加 true 修改\n\n  const ownerFormRef = ref(null); // 业主 Form 引用\n\n  const showOwnerModal = ref(false); // 模态框是否打开\n  // 表单校验\n\n  const ownerRules = {\n    user: {\n      name: {\n        required: true,\n        message: \"请输入姓名\",\n        trigger: \"blur\"\n      },\n      gender: {\n        required: true,\n        type: \"number\",\n        message: \"请选择性别\",\n        trigger: \"blur\"\n      },\n      age: {\n        required: true,\n        message: \"请输入年龄\",\n        trigger: \"blur\"\n      },\n      phone: {\n        required: true,\n        message: \"请输入手机号码\",\n        trigger: \"blur\"\n      }\n    }\n  }; // 表单输入数据\n\n  const ownerformValue = ref({\n    user: {\n      name: \"\",\n      gender: null,\n      age: \"\",\n      idCard: \"\",\n      phone: \"\",\n      remark: \"\",\n      weCat: \"\",\n      isMember: 0\n    }\n  }); // 表单提交事件\n\n  const ownerSubmit = e => {\n    e.preventDefault();\n    ownerFormRef.value?.validate(errors => {\n      if (!errors) {\n        // 校验通过\n        if (!ownerStatus.value) {\n          // 添加\n          addOwner();\n        } else {// 修改\n        }\n      } else {// 校验不通过\n      }\n    });\n  }; // 业主添加加载\n\n\n  const ownerModelLoading = ref(false);\n  /**\r\n   * 添加业主\r\n   */\n\n  const addOwner = () => {\n    ownerModelLoading.value = true;\n    ownerformValue.value.user.ownerNo = createId();\n    axios({\n      method: 'post',\n      url: global.api + '/addOwner',\n      data: QueryString.stringify(ownerformValue.value.user)\n    }).then(res => {\n      if (res.data.success) {\n        message.success(\"添加成功！\");\n        refreshOwnerData(); // 刷新业主数据\n\n        showOwnerModal.value = false; // 关闭模态框\n      } else {\n        message.warning(\"添加失败！\");\n      }\n    }).catch(err => {\n      message.error(\"添加业主出现异常！\" + err);\n    }).finally(() => {\n      ownerModelLoading.value = false;\n    });\n  }; // 性别选择框数据\n\n\n  const ownerGenderOptions = ref(['男', '女'].map((v, i) => ({\n    label: v,\n    value: i\n  })));\n  /**\r\n   * 打开模态框\r\n   * @param {false 添加 true 修改} status\r\n   */\n\n  const openOwnerModal = status => {\n    showOwnerModal.value = true;\n    ownerStatus.value = status;\n  };\n  /**\r\n   * 关闭模态框\r\n   */\n\n\n  const closeOwnerModal = () => {\n    showOwnerModal.value = false;\n  };\n  /**\r\n   * 删除业主信息\r\n   * @param {*} id  业主编号\r\n   */\n\n\n  const deleteOwner = id => {};\n\n  return {\n    ownerStatus,\n    // 模态 添加 or 修改 框状态\n    ownerFormRef,\n    // 业主 Form 引用\n    showOwnerModal,\n    // 显示模态框\n    ownerRules,\n    // 表单校验\n    ownerformValue,\n    // 表单参数\n    ownerGenderOptions,\n    // 性别选项数据\n    ownerModelLoading,\n    // 业主加载\n    openOwnerModal,\n    // 打开模态框\n    closeOwnerModal,\n    // 关闭模态框\n    ownerSubmit,\n    // 表单提交\n    deleteOwner // 删除业主信息\n\n  };\n});","map":{"version":3,"names":["ref","inject","useMessage","QueryString","axios","createId","refreshOwnerData","global","message","ownerStatus","ownerFormRef","showOwnerModal","ownerRules","user","name","required","trigger","gender","type","age","phone","ownerformValue","idCard","remark","weCat","isMember","ownerSubmit","e","preventDefault","value","validate","errors","addOwner","ownerModelLoading","ownerNo","method","url","api","data","stringify","then","res","success","warning","catch","err","error","finally","ownerGenderOptions","map","v","i","label","openOwnerModal","status","closeOwnerModal","deleteOwner","id"],"sources":["E:/VCode/SHC社区管理系统/shc_community_manager_system/src/hook/real_estate/ownerInformation/ownerHook.js"],"sourcesContent":["// 添加业主\r\nimport { ref, inject } from 'vue'\r\nimport { useMessage } from 'naive-ui'\r\nimport QueryString from 'qs'\r\nimport axios from 'axios'\r\nimport { createId } from '../../../util/BaseUtil'\r\n\r\nexport default (refreshOwnerData) => {\r\n    // 接收全局变量\r\n    const global = inject(\"global\")\r\n    // 获取消息对象\r\n    const message = useMessage();\r\n\r\n    // 业主 模态框\r\n    const ownerStatus = ref(false); // false 添加 true 修改\r\n    const ownerFormRef = ref(null); // 业主 Form 引用\r\n    const showOwnerModal = ref(false) // 模态框是否打开\r\n\r\n    // 表单校验\r\n    const ownerRules = {\r\n        user: {\r\n            name: {\r\n                required: true,\r\n                message: \"请输入姓名\",\r\n                trigger: \"blur\"\r\n            },\r\n            gender: {\r\n                required: true,\r\n                type: \"number\",\r\n                message: \"请选择性别\",\r\n                trigger: \"blur\"\r\n            },\r\n            age: {\r\n                required: true,\r\n                message: \"请输入年龄\",\r\n                trigger: \"blur\"\r\n            },\r\n            phone: {\r\n                required: true,\r\n                message: \"请输入手机号码\",\r\n                trigger: \"blur\"\r\n            },\r\n        },\r\n    }\r\n    // 表单输入数据\r\n    const ownerformValue = ref({\r\n        user: {\r\n            name: \"\",\r\n            gender: null,\r\n            age: \"\",\r\n            idCard: \"\",\r\n            phone: \"\",\r\n            remark: \"\",\r\n            weCat: \"\",\r\n            isMember: 0\r\n        },\r\n    })\r\n\r\n    // 表单提交事件\r\n    const ownerSubmit = (e) => {\r\n        e.preventDefault();\r\n        ownerFormRef.value?.validate((errors) => {\r\n            if (!errors) {\r\n                // 校验通过\r\n                if (!ownerStatus.value) { // 添加\r\n                    addOwner()\r\n                } else { // 修改\r\n\r\n                }\r\n            } else {\r\n                // 校验不通过\r\n            }\r\n        });\r\n    }\r\n\r\n    // 业主添加加载\r\n    const ownerModelLoading = ref(false);\r\n    /**\r\n     * 添加业主\r\n     */\r\n    const addOwner = () => {\r\n        ownerModelLoading.value = true\r\n        ownerformValue.value.user.ownerNo = createId()\r\n        axios({\r\n            method: 'post',\r\n            url: global.api + '/addOwner',\r\n            data: QueryString.stringify(ownerformValue.value.user)\r\n        }).then(res => {\r\n            if (res.data.success) {\r\n                message.success(\"添加成功！\")\r\n                refreshOwnerData() // 刷新业主数据\r\n                showOwnerModal.value = false // 关闭模态框\r\n            } else {\r\n                message.warning(\"添加失败！\")\r\n            }\r\n        }).catch(err => {\r\n            message.error(\"添加业主出现异常！\" + err)\r\n        }).finally(() => {\r\n            ownerModelLoading.value = false\r\n        })\r\n    }\r\n\r\n    // 性别选择框数据\r\n    const ownerGenderOptions = ref(['男', '女'].map(\r\n        (v,i) => ({\r\n            label: v,\r\n            value: i\r\n        })\r\n    ))\r\n\r\n    /**\r\n     * 打开模态框\r\n     * @param {false 添加 true 修改} status\r\n     */\r\n    const openOwnerModal = (status) => {\r\n        showOwnerModal.value = true;\r\n        ownerStatus.value = status\r\n    }\r\n\r\n    /**\r\n     * 关闭模态框\r\n     */\r\n    const closeOwnerModal = () => {\r\n        showOwnerModal.value = false;\r\n    }\r\n\r\n    /**\r\n     * 删除业主信息\r\n     * @param {*} id  业主编号\r\n     */\r\n    const deleteOwner = (id) => {\r\n\r\n    }\r\n\r\n    return {\r\n        ownerStatus, // 模态 添加 or 修改 框状态\r\n        ownerFormRef, // 业主 Form 引用\r\n        showOwnerModal, // 显示模态框\r\n        ownerRules, // 表单校验\r\n        ownerformValue, // 表单参数\r\n        ownerGenderOptions, // 性别选项数据\r\n        ownerModelLoading, // 业主加载\r\n        openOwnerModal, // 打开模态框\r\n        closeOwnerModal, // 关闭模态框\r\n        ownerSubmit, // 表单提交\r\n        deleteOwner, // 删除业主信息\r\n    }\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}