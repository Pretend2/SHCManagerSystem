{"ast":null,"code":"import { warn } from '../utils';\n\nclass ZIndexManager {\n  constructor() {\n    this.elementZIndex = new Map();\n    this.nextZIndex = 2000;\n  }\n\n  get elementCount() {\n    return this.elementZIndex.size;\n  }\n\n  ensureZIndex(el, zIndex) {\n    const {\n      elementZIndex\n    } = this;\n\n    if (zIndex !== undefined) {\n      el.style.zIndex = `${zIndex}`;\n      elementZIndex.delete(el);\n      return;\n    }\n\n    const {\n      nextZIndex\n    } = this;\n\n    if (elementZIndex.has(el)) {\n      const currentZIndex = elementZIndex.get(el);\n      if (currentZIndex + 1 === this.nextZIndex) return;\n    }\n\n    el.style.zIndex = `${nextZIndex}`;\n    elementZIndex.set(el, nextZIndex);\n    this.nextZIndex = nextZIndex + 1;\n    this.squashState();\n  }\n\n  unregister(el, zIndex) {\n    const {\n      elementZIndex\n    } = this;\n\n    if (elementZIndex.has(el)) {\n      elementZIndex.delete(el);\n    } else if (zIndex === undefined) {\n      warn('z-index-manager/unregister-element', 'Element not found when unregistering.');\n    }\n\n    this.squashState();\n  }\n\n  squashState() {\n    const {\n      elementCount\n    } = this;\n\n    if (!elementCount) {\n      this.nextZIndex = 2000;\n    }\n\n    if (this.nextZIndex - elementCount > 2500) this.rearrange();\n  }\n\n  rearrange() {\n    const elementZIndexPair = Array.from(this.elementZIndex.entries());\n    elementZIndexPair.sort((pair1, pair2) => {\n      return pair1[1] - pair2[1];\n    });\n    this.nextZIndex = 2000;\n    elementZIndexPair.forEach(pair => {\n      const el = pair[0];\n      const zIndex = this.nextZIndex++;\n      if (`${zIndex}` !== el.style.zIndex) el.style.zIndex = `${zIndex}`;\n    });\n  }\n\n}\n\nexport default new ZIndexManager();","map":{"version":3,"names":["warn","ZIndexManager","constructor","elementZIndex","Map","nextZIndex","elementCount","size","ensureZIndex","el","zIndex","undefined","style","delete","has","currentZIndex","get","set","squashState","unregister","rearrange","elementZIndexPair","Array","from","entries","sort","pair1","pair2","forEach","pair"],"sources":["D:/VCode/SHC社区管理系统/shc_community_manager_system/node_modules/vdirs/es/zindexable/z-index-manager.js"],"sourcesContent":["import { warn } from '../utils';\nclass ZIndexManager {\n    constructor() {\n        this.elementZIndex = new Map();\n        this.nextZIndex = 2000;\n    }\n    get elementCount() {\n        return this.elementZIndex.size;\n    }\n    ensureZIndex(el, zIndex) {\n        const { elementZIndex } = this;\n        if (zIndex !== undefined) {\n            el.style.zIndex = `${zIndex}`;\n            elementZIndex.delete(el);\n            return;\n        }\n        const { nextZIndex } = this;\n        if (elementZIndex.has(el)) {\n            const currentZIndex = elementZIndex.get(el);\n            if (currentZIndex + 1 === this.nextZIndex)\n                return;\n        }\n        el.style.zIndex = `${nextZIndex}`;\n        elementZIndex.set(el, nextZIndex);\n        this.nextZIndex = nextZIndex + 1;\n        this.squashState();\n    }\n    unregister(el, zIndex) {\n        const { elementZIndex } = this;\n        if (elementZIndex.has(el)) {\n            elementZIndex.delete(el);\n        }\n        else if (zIndex === undefined) {\n            warn('z-index-manager/unregister-element', 'Element not found when unregistering.');\n        }\n        this.squashState();\n    }\n    squashState() {\n        const { elementCount } = this;\n        if (!elementCount) {\n            this.nextZIndex = 2000;\n        }\n        if (this.nextZIndex - elementCount > 2500)\n            this.rearrange();\n    }\n    rearrange() {\n        const elementZIndexPair = Array.from(this.elementZIndex.entries());\n        elementZIndexPair.sort((pair1, pair2) => {\n            return pair1[1] - pair2[1];\n        });\n        this.nextZIndex = 2000;\n        elementZIndexPair.forEach((pair) => {\n            const el = pair[0];\n            const zIndex = this.nextZIndex++;\n            if (`${zIndex}` !== el.style.zIndex)\n                el.style.zIndex = `${zIndex}`;\n        });\n    }\n}\nexport default new ZIndexManager();\n"],"mappings":"AAAA,SAASA,IAAT,QAAqB,UAArB;;AACA,MAAMC,aAAN,CAAoB;EAChBC,WAAW,GAAG;IACV,KAAKC,aAAL,GAAqB,IAAIC,GAAJ,EAArB;IACA,KAAKC,UAAL,GAAkB,IAAlB;EACH;;EACe,IAAZC,YAAY,GAAG;IACf,OAAO,KAAKH,aAAL,CAAmBI,IAA1B;EACH;;EACDC,YAAY,CAACC,EAAD,EAAKC,MAAL,EAAa;IACrB,MAAM;MAAEP;IAAF,IAAoB,IAA1B;;IACA,IAAIO,MAAM,KAAKC,SAAf,EAA0B;MACtBF,EAAE,CAACG,KAAH,CAASF,MAAT,GAAmB,GAAEA,MAAO,EAA5B;MACAP,aAAa,CAACU,MAAd,CAAqBJ,EAArB;MACA;IACH;;IACD,MAAM;MAAEJ;IAAF,IAAiB,IAAvB;;IACA,IAAIF,aAAa,CAACW,GAAd,CAAkBL,EAAlB,CAAJ,EAA2B;MACvB,MAAMM,aAAa,GAAGZ,aAAa,CAACa,GAAd,CAAkBP,EAAlB,CAAtB;MACA,IAAIM,aAAa,GAAG,CAAhB,KAAsB,KAAKV,UAA/B,EACI;IACP;;IACDI,EAAE,CAACG,KAAH,CAASF,MAAT,GAAmB,GAAEL,UAAW,EAAhC;IACAF,aAAa,CAACc,GAAd,CAAkBR,EAAlB,EAAsBJ,UAAtB;IACA,KAAKA,UAAL,GAAkBA,UAAU,GAAG,CAA/B;IACA,KAAKa,WAAL;EACH;;EACDC,UAAU,CAACV,EAAD,EAAKC,MAAL,EAAa;IACnB,MAAM;MAAEP;IAAF,IAAoB,IAA1B;;IACA,IAAIA,aAAa,CAACW,GAAd,CAAkBL,EAAlB,CAAJ,EAA2B;MACvBN,aAAa,CAACU,MAAd,CAAqBJ,EAArB;IACH,CAFD,MAGK,IAAIC,MAAM,KAAKC,SAAf,EAA0B;MAC3BX,IAAI,CAAC,oCAAD,EAAuC,uCAAvC,CAAJ;IACH;;IACD,KAAKkB,WAAL;EACH;;EACDA,WAAW,GAAG;IACV,MAAM;MAAEZ;IAAF,IAAmB,IAAzB;;IACA,IAAI,CAACA,YAAL,EAAmB;MACf,KAAKD,UAAL,GAAkB,IAAlB;IACH;;IACD,IAAI,KAAKA,UAAL,GAAkBC,YAAlB,GAAiC,IAArC,EACI,KAAKc,SAAL;EACP;;EACDA,SAAS,GAAG;IACR,MAAMC,iBAAiB,GAAGC,KAAK,CAACC,IAAN,CAAW,KAAKpB,aAAL,CAAmBqB,OAAnB,EAAX,CAA1B;IACAH,iBAAiB,CAACI,IAAlB,CAAuB,CAACC,KAAD,EAAQC,KAAR,KAAkB;MACrC,OAAOD,KAAK,CAAC,CAAD,CAAL,GAAWC,KAAK,CAAC,CAAD,CAAvB;IACH,CAFD;IAGA,KAAKtB,UAAL,GAAkB,IAAlB;IACAgB,iBAAiB,CAACO,OAAlB,CAA2BC,IAAD,IAAU;MAChC,MAAMpB,EAAE,GAAGoB,IAAI,CAAC,CAAD,CAAf;MACA,MAAMnB,MAAM,GAAG,KAAKL,UAAL,EAAf;MACA,IAAK,GAAEK,MAAO,EAAV,KAAgBD,EAAE,CAACG,KAAH,CAASF,MAA7B,EACID,EAAE,CAACG,KAAH,CAASF,MAAT,GAAmB,GAAEA,MAAO,EAA5B;IACP,CALD;EAMH;;AAxDe;;AA0DpB,eAAe,IAAIT,aAAJ,EAAf"},"metadata":{},"sourceType":"module"}