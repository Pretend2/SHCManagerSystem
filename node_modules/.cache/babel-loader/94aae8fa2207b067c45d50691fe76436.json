{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createTextVNode as _createTextVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"padding\": \"0 10px\"\n  }\n};\n\nconst _hoisted_2 = /*#__PURE__*/_createTextVNode(\" 查询 \");\n\nconst _hoisted_3 = /*#__PURE__*/_createTextVNode(\" 重置 \");\n\nconst _hoisted_4 = /*#__PURE__*/_createTextVNode(\" 登记 \");\n\nconst _hoisted_5 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", null, [/*#__PURE__*/_createElementVNode(\"th\", null, \"访客ID\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"访客姓名/性别\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"访客联系方式\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"业主姓名\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"来访事由/类型\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"车牌号\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"创建时间\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"来访/离开时间\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"状态\"), /*#__PURE__*/_createElementVNode(\"th\", null, \"操作\")])], -1\n/* HOISTED */\n);\n\nconst _hoisted_6 = [\"innerHTML\"];\n\nconst _hoisted_7 = /*#__PURE__*/_createTextVNode(\"修改\");\n\nconst _hoisted_8 = /*#__PURE__*/_createTextVNode(\"删除\");\n\nconst _hoisted_9 = /*#__PURE__*/_createTextVNode(\"取消\");\n\nconst _hoisted_10 = /*#__PURE__*/_createTextVNode(\"提交\");\n\nconst _hoisted_11 = {\n  key: 0,\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"center\",\n    \"align-items\": \"center\",\n    \"margin-top\": \"10px\",\n    \"margin-bottom\": \"10px\"\n  }\n};\nexport function render(_ctx, _cache) {\n  const _component_n_input = _resolveComponent(\"n-input\");\n\n  const _component_n_date_picker = _resolveComponent(\"n-date-picker\");\n\n  const _component_search_icon = _resolveComponent(\"search-icon\");\n\n  const _component_n_icon = _resolveComponent(\"n-icon\");\n\n  const _component_n_button = _resolveComponent(\"n-button\");\n\n  const _component_arrow_clockwise_icon = _resolveComponent(\"arrow-clockwise-icon\");\n\n  const _component_n_space = _resolveComponent(\"n-space\");\n\n  const _component_n_card = _resolveComponent(\"n-card\");\n\n  const _component_add_icon = _resolveComponent(\"add-icon\");\n\n  const _component_n_ellipsis = _resolveComponent(\"n-ellipsis\");\n\n  const _component_n_button_group = _resolveComponent(\"n-button-group\");\n\n  const _component_n_table = _resolveComponent(\"n-table\");\n\n  const _component_n_form_item = _resolveComponent(\"n-form-item\");\n\n  const _component_n_select = _resolveComponent(\"n-select\");\n\n  const _component_n_grid_item = _resolveComponent(\"n-grid-item\");\n\n  const _component_n_grid = _resolveComponent(\"n-grid\");\n\n  const _component_n_form = _resolveComponent(\"n-form\");\n\n  const _component_n_modal = _resolveComponent(\"n-modal\");\n\n  const _component_n_pagination = _resolveComponent(\"n-pagination\");\n\n  const _component_n_spin = _resolveComponent(\"n-spin\");\n\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createVNode(_component_n_card, {\n    title: \"访客信息\",\n    style: {\n      \"margin-top\": \"10px\"\n    }\n  }, {\n    default: _withCtx(() => [_createVNode(_component_n_space, {\n      \"item-style\": \"display: flex; align-item: center;\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_n_input, {\n        value: _ctx.findData.name,\n        \"onUpdate:value\": _cache[0] || (_cache[0] = $event => _ctx.findData.name = $event),\n        type: \"text\",\n        placeholder: \"请填写来访人姓名\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode(_component_n_input, {\n        value: _ctx.findData.phone,\n        \"onUpdate:value\": _cache[1] || (_cache[1] = $event => _ctx.findData.phone = $event),\n        type: \"text\",\n        placeholder: \"请填写来访人联系方式\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode(_component_n_date_picker, {\n        value: _ctx.findData.dataRange,\n        \"onUpdate:value\": _cache[2] || (_cache[2] = $event => _ctx.findData.dataRange = $event),\n        type: \"datetimerange\",\n        clearable: \"\"\n      }, null, 8\n      /* PROPS */\n      , [\"value\"]), _createVNode(_component_n_button, {\n        onClick: _ctx.findTouRegData,\n        type: \"primary\"\n      }, {\n        icon: _withCtx(() => [_createVNode(_component_n_icon, null, {\n          default: _withCtx(() => [_createVNode(_component_search_icon)]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        default: _withCtx(() => [_hoisted_2]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"onClick\"]), _createVNode(_component_n_button, {\n        onClick: _ctx.resetTouReg\n      }, {\n        icon: _withCtx(() => [_createVNode(_component_n_icon, null, {\n          default: _withCtx(() => [_createVNode(_component_arrow_clockwise_icon)]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        default: _withCtx(() => [_hoisted_3]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"onClick\"])]),\n      _: 1\n      /* STABLE */\n\n    })]),\n    _: 1\n    /* STABLE */\n\n  }), _createVNode(_component_n_spin, {\n    show: _ctx.touRegLoading\n  }, {\n    default: _withCtx(() => [_createVNode(_component_n_card, {\n      title: \"公告信息\",\n      style: {\n        \"margin-top\": \"10px\",\n        \"padding\": \"0\",\n        \"margin-bottom\": \"10px\"\n      }\n    }, {\n      \"header-extra\": _withCtx(() => [_createVNode(_component_n_space, null, {\n        default: _withCtx(() => [_createVNode(_component_n_button, {\n          onClick: _cache[3] || (_cache[3] = $event => _ctx.openTouRegModal('add')),\n          type: \"primary\"\n        }, {\n          icon: _withCtx(() => [_createVNode(_component_n_icon, null, {\n            default: _withCtx(() => [_createVNode(_component_add_icon)]),\n            _: 1\n            /* STABLE */\n\n          })]),\n          default: _withCtx(() => [_hoisted_4]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      default: _withCtx(() => [_createVNode(_component_n_table, {\n        style: {\n          \"margin-top\": \"10px\"\n        },\n        striped: \"\"\n      }, {\n        default: _withCtx(() => [_hoisted_5, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.touRegData, (item, index) => {\n          return _openBlock(), _createElementBlock(\"tr\", {\n            key: index\n          }, [_createElementVNode(\"td\", null, [_createVNode(_component_n_ellipsis, {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.visitorsNo), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, [_createVNode(_component_n_ellipsis, {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.name) + \"/\" + _toDisplayString(item.gender === 1 ? '男' : '女'), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, _toDisplayString(item.phone), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, _toDisplayString(item.owner.name), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, [_createVNode(_component_n_ellipsis, {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.reason) + \"(\" + _toDisplayString(item.type === 0 ? '白事' : '喜事') + \") \", 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, _toDisplayString(item.carNo), 1\n          /* TEXT */\n          ), _createElementVNode(\"td\", null, [_createVNode(_component_n_ellipsis, {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.createTime), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", null, [_createVNode(_component_n_ellipsis, {\n            style: {\n              \"max-width\": \"80px\"\n            }\n          }, {\n            default: _withCtx(() => [_createTextVNode(_toDisplayString(item.visitingTime) + \"/\" + _toDisplayString(item.leaveTime), 1\n            /* TEXT */\n            )]),\n            _: 2\n            /* DYNAMIC */\n\n          }, 1024\n          /* DYNAMIC_SLOTS */\n          )]), _createElementVNode(\"td\", {\n            innerHTML: new Date(item.leaveTime).getTime() >= new Date().getTime() ? '<span style=\\'color:green\\'>已生效</span>' : '<span style=\\'color:red\\'>已失效</span>'\n          }, null, 8\n          /* PROPS */\n          , _hoisted_6), _createElementVNode(\"td\", null, [_createVNode(_component_n_button_group, {\n            size: \"large\"\n          }, {\n            default: _withCtx(() => [_createVNode(_component_n_button, {\n              size: \"small\"\n            }, {\n              default: _withCtx(() => [_hoisted_7]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_button, {\n              type: \"error\",\n              size: \"small\",\n              strong: \"\",\n              secondary: \"\"\n            }, {\n              default: _withCtx(() => [_hoisted_8]),\n              _: 1\n              /* STABLE */\n\n            })]),\n            _: 1\n            /* STABLE */\n\n          })])]);\n        }), 128\n        /* KEYED_FRAGMENT */\n        ))])]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      _: 1\n      /* STABLE */\n\n    }), _createVNode(_component_n_modal, {\n      \"auto-focus\": false,\n      show: _ctx.showTouRegModal,\n      \"onUpdate:show\": _cache[13] || (_cache[13] = $event => _ctx.showTouRegModal = $event),\n      class: \"custom-card\",\n      preset: \"card\",\n      style: {\n        \"width\": \"600px\"\n      },\n      title: \"访客登记\",\n      \"transform-origin\": \"center\",\n      size: \"huge\",\n      bordered: false,\n      segmented: {\n        content: 'soft',\n        footer: 'soft'\n      }\n    }, {\n      footer: _withCtx(() => [_createVNode(_component_n_space, {\n        justify: \"end\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_n_button, {\n          onClick: _cache[12] || (_cache[12] = $event => _ctx.showTouRegModal = false)\n        }, {\n          default: _withCtx(() => [_hoisted_9]),\n          _: 1\n          /* STABLE */\n\n        }), _createVNode(_component_n_button, {\n          loading: _ctx.submitTouRegLoading,\n          onClick: _ctx.rouRegSubmit,\n          type: \"primary\",\n          \"attr-type\": \"button\"\n        }, {\n          default: _withCtx(() => [_hoisted_10]),\n          _: 1\n          /* STABLE */\n\n        }, 8\n        /* PROPS */\n        , [\"loading\", \"onClick\"])]),\n        _: 1\n        /* STABLE */\n\n      })]),\n      default: _withCtx(() => [_createVNode(_component_n_form, {\n        ref: \"touRegFormRef\",\n        \"label-placement\": \"left\",\n        \"label-width\": 80,\n        size: \"medium\",\n        model: _ctx.touRegValue,\n        rules: _ctx.touRegRules\n      }, {\n        default: _withCtx(() => [_createVNode(_component_n_grid, {\n          cols: \"1\"\n        }, {\n          default: _withCtx(() => [_createVNode(_component_n_grid_item, null, {\n            default: _withCtx(() => [_createVNode(_component_n_form_item, {\n              label: \"访客姓名\",\n              path: \"name\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_input, {\n                placeholder: \"请输入访客姓名\",\n                value: _ctx.touRegValue.name,\n                \"onUpdate:value\": _cache[4] || (_cache[4] = $event => _ctx.touRegValue.name = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"访客性别\",\n              path: \"gender\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_select, {\n                placeholder: \"请选择性别\",\n                value: _ctx.touRegValue.gender,\n                \"onUpdate:value\": _cache[5] || (_cache[5] = $event => _ctx.touRegValue.gender = $event),\n                style: {\n                  \"width\": \"180px\"\n                },\n                options: _ctx.touRegGender,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\", \"options\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"联系方式\",\n              path: \"phone\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_input, {\n                placeholder: \"请输入联系方式\",\n                value: _ctx.touRegValue.phone,\n                \"onUpdate:value\": _cache[6] || (_cache[6] = $event => _ctx.touRegValue.phone = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"车牌号\",\n              path: \"carNo\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_input, {\n                placeholder: \"请输入车牌号\",\n                value: _ctx.touRegValue.carNo,\n                \"onUpdate:value\": _cache[7] || (_cache[7] = $event => _ctx.touRegValue.carNo = $event)\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"时间\",\n              path: \"dataRange\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_date_picker, {\n                type: \"datetimerange\",\n                value: _ctx.touRegValue.dataRange,\n                \"onUpdate:value\": _cache[8] || (_cache[8] = $event => _ctx.touRegValue.dataRange = $event),\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"目标业主\",\n              path: \"ownerNo\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_select, {\n                filterable: \"\",\n                placeholder: \"请选择目标业主\",\n                value: _ctx.touRegValue.ownerNo,\n                \"onUpdate:value\": _cache[9] || (_cache[9] = $event => _ctx.touRegValue.ownerNo = $event),\n                options: _ctx.targetOwnerInfo,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\", \"options\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"事由类型\",\n              path: \"type\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_select, {\n                filterable: \"\",\n                placeholder: \"请选择事由类型\",\n                value: _ctx.touRegValue.type,\n                \"onUpdate:value\": _cache[10] || (_cache[10] = $event => _ctx.touRegValue.type = $event),\n                options: _ctx.reasonInfo,\n                clearable: \"\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\", \"options\"])]),\n              _: 1\n              /* STABLE */\n\n            }), _createVNode(_component_n_form_item, {\n              label: \"拜访事由\",\n              path: \"reason\"\n            }, {\n              default: _withCtx(() => [_createVNode(_component_n_input, {\n                placeholder: \"请输入拜访事由\",\n                value: _ctx.touRegValue.reason,\n                \"onUpdate:value\": _cache[11] || (_cache[11] = $event => _ctx.touRegValue.reason = $event),\n                type: \"textarea\"\n              }, null, 8\n              /* PROPS */\n              , [\"value\"])]),\n              _: 1\n              /* STABLE */\n\n            })]),\n            _: 1\n            /* STABLE */\n\n          })]),\n          _: 1\n          /* STABLE */\n\n        })]),\n        _: 1\n        /* STABLE */\n\n      }, 8\n      /* PROPS */\n      , [\"model\", \"rules\"])]),\n      _: 1\n      /* STABLE */\n\n    }, 8\n    /* PROPS */\n    , [\"show\"]), _ctx.pages > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [_createVNode(_component_n_pagination, {\n      \"onUpdate:page\": _ctx.touRegPageChange,\n      \"page-count\": _ctx.pages\n    }, null, 8\n    /* PROPS */\n    , [\"onUpdate:page\", \"page-count\"])])) : _createCommentVNode(\"v-if\", true)]),\n    _: 1\n    /* STABLE */\n\n  }, 8\n  /* PROPS */\n  , [\"show\"])]);\n}","map":{"version":3,"mappings":"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","names":["style","_createElementVNode","_createElementBlock","_createVNode","_component_n_card","title","_component_n_space","_component_n_input","value","_ctx","name","$event","type","placeholder","clearable","phone","_component_n_date_picker","dataRange","_component_n_button","onClick","icon","_component_n_icon","_component_search_icon","_component_arrow_clockwise_icon","_component_n_spin","show","_withCtx","_component_add_icon","_component_n_table","striped","_hoisted_5","_Fragment","_renderList","item","index","key","_component_n_ellipsis","visitorsNo","_toDisplayString","gender","owner","reason","carNo","createTime","visitingTime","leaveTime","innerHTML","Date","getTime","_component_n_button_group","size","strong","secondary","_component_n_modal","class","preset","bordered","segmented","content","footer","justify","loading","_component_n_form","ref","model","rules","_component_n_grid","cols","_component_n_grid_item","_component_n_form_item","label","path","_component_n_select","options","filterable","ownerNo","_component_n_pagination"],"sourceRoot":"","sources":["D:\\VCode\\SHC社区管理系统\\shc_community_manager_system\\src\\layout\\office\\TouristRegistrationLayout.vue"],"sourcesContent":["<template>\r\n  <div style=\"padding: 0 10px\">\r\n    <n-card title=\"访客信息\" style=\"margin-top: 10px\">\r\n      <n-space item-style=\"display: flex; align-item: center;\">\r\n        <n-input v-model:value=\"findData.name\" type=\"text\" placeholder=\"请填写来访人姓名\" clearable />\r\n        <n-input v-model:value=\"findData.phone\" type=\"text\" placeholder=\"请填写来访人联系方式\" clearable />\r\n        <n-date-picker v-model:value=\"findData.dataRange\" type=\"datetimerange\" clearable />\r\n        <n-button @click=\"findTouRegData\" type=\"primary\">\r\n          <template #icon>\r\n            <n-icon>\r\n              <search-icon />\r\n            </n-icon>\r\n          </template>\r\n          查询\r\n        </n-button>\r\n        <n-button @click=\"resetTouReg\">\r\n          <template #icon>\r\n            <n-icon>\r\n              <arrow-clockwise-icon />\r\n            </n-icon>\r\n          </template>\r\n          重置\r\n        </n-button>\r\n      </n-space>\r\n    </n-card>\r\n\r\n    <n-spin :show=\"touRegLoading\">\r\n      <n-card title=\"公告信息\" style=\"margin-top: 10px;padding: 0; margin-bottom: 10px;\">\r\n        <template #header-extra>\r\n          <n-space>\r\n            <n-button @click=\"openTouRegModal('add')\" type=\"primary\">\r\n              <template #icon>\r\n                <n-icon>\r\n                  <add-icon />\r\n                </n-icon>\r\n              </template>\r\n              登记\r\n            </n-button>\r\n          </n-space>\r\n        </template>\r\n        <n-table style=\"margin-top: 10px\" striped>\r\n          <thead>\r\n            <tr>\r\n              <th>访客ID</th>\r\n              <th>访客姓名/性别</th>\r\n              <th>访客联系方式</th>\r\n              <th>业主姓名</th>\r\n              <th>来访事由/类型</th>\r\n              <th>车牌号</th>\r\n              <th>创建时间</th>\r\n              <th>来访/离开时间</th>\r\n              <th>状态</th>\r\n              <th>操作</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr v-for=\"(item, index) in touRegData\" :key=\"index\">\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.visitorsNo }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.name }}/{{ item.gender === 1 ? '男' : '女' }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>{{ item.phone }}</td>\r\n              <td>{{ item.owner.name }}</td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.reason }}({{ item.type === 0 ? '白事' : '喜事' }})\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                {{ item.carNo }}\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.createTime }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td>\r\n                <n-ellipsis style=\"max-width: 80px\">\r\n                  {{ item.visitingTime }}/{{ item.leaveTime }}\r\n                </n-ellipsis>\r\n              </td>\r\n              <td v-html=\"new Date(item.leaveTime).getTime() >= new Date().getTime() ?\r\n              '<span style=\\'color:green\\'>已生效</span>' : '<span style=\\'color:red\\'>已失效</span>'\"></td>\r\n              <td>\r\n                <n-button-group size=\"large\">\r\n                  <n-button size=\"small\">修改</n-button>\r\n                  <n-button type=\"error\" size=\"small\" strong secondary>删除</n-button>\r\n                </n-button-group>\r\n              </td>\r\n            </tr>\r\n          </tbody>\r\n        </n-table>\r\n      </n-card>\r\n\r\n      <n-modal :auto-focus=\"false\" v-model:show=\"showTouRegModal\" class=\"custom-card\" preset=\"card\" style=\"width: 600px\"\r\n        title=\"访客登记\" transform-origin=\"center\" size=\"huge\" :bordered=\"false\"\r\n        :segmented=\"{ content: 'soft', footer: 'soft' }\">\r\n        <n-form ref=\"touRegFormRef\" label-placement=\"left\" :label-width=\"80\" size=\"medium\" :model=\"touRegValue\"\r\n          :rules=\"touRegRules\">\r\n          <n-grid cols=\"1\">\r\n            <n-grid-item>\r\n              <n-form-item label=\"访客姓名\" path=\"name\">\r\n                <n-input placeholder=\"请输入访客姓名\" v-model:value=\"touRegValue.name\"/>\r\n              </n-form-item>\r\n              <n-form-item label=\"访客性别\" path=\"gender\">\r\n                <n-select placeholder=\"请选择性别\" v-model:value=\"touRegValue.gender\" style=\"width: 180px\" :options=\"touRegGender\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"联系方式\" path=\"phone\">\r\n                <n-input placeholder=\"请输入联系方式\" v-model:value=\"touRegValue.phone\" />\r\n              </n-form-item>\r\n              <n-form-item label=\"车牌号\" path=\"carNo\">\r\n                <n-input placeholder=\"请输入车牌号\" v-model:value=\"touRegValue.carNo\" />\r\n              </n-form-item>\r\n              <n-form-item label=\"时间\" path=\"dataRange\">\r\n                <n-date-picker type=\"datetimerange\" v-model:value=\"touRegValue.dataRange\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"目标业主\" path=\"ownerNo\">\r\n                <n-select filterable placeholder=\"请选择目标业主\" v-model:value=\"touRegValue.ownerNo\" :options=\"targetOwnerInfo\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"事由类型\" path=\"type\">\r\n                <n-select filterable placeholder=\"请选择事由类型\" v-model:value=\"touRegValue.type\" :options=\"reasonInfo\" clearable />\r\n              </n-form-item>\r\n              <n-form-item label=\"拜访事由\" path=\"reason\">\r\n                <n-input placeholder=\"请输入拜访事由\" v-model:value=\"touRegValue.reason\" type=\"textarea\" />\r\n              </n-form-item>\r\n            </n-grid-item>\r\n          </n-grid>\r\n        </n-form>\r\n        <template #footer>\r\n          <n-space justify=\"end\">\r\n            <n-button @click=\"showTouRegModal = false\">取消</n-button>\r\n            <n-button :loading=\"submitTouRegLoading\" @click=\"rouRegSubmit\" type=\"primary\" attr-type=\"button\">提交</n-button>\r\n          </n-space>\r\n        </template>\r\n      </n-modal>\r\n\r\n      <div v-if=\"pages > 1\"\r\n        style=\"display: flex;justify-content: center;align-items: center;margin-top: 10px;margin-bottom: 10px;\">\r\n        <n-pagination @update:page=\"touRegPageChange\" :page-count=\"pages\" />\r\n      </div>\r\n    </n-spin>\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\n\r\n// 引入 vue\r\nimport { ref, inject, computed } from 'vue'\r\n// 引入 naive-ui 组件\r\nimport {\r\n  NCard, NSpace, NInput, NButton, NTable,\r\n  NIcon, NPagination, NButtonGroup, NGrid,\r\n  NEllipsis, NSelect, NDatePicker, useMessage,\r\n  useDialog, NSpin, NForm, NFormItem, NModal,\r\n  NGridItem\r\n} from 'naive-ui'\r\n// 引入图标 \r\nimport {\r\n  Add16Regular as AddIcon,\r\n  Edit16Regular as EditIcon,\r\n  Delete16Regular as DeleteIcon,\r\n  Search16Regular as SearchIcon,\r\n  ArrowClockwise16Regular as ArrowClockwiseIcon,\r\n  CaretDown12Filled as CaretDownIcon,\r\n} from '@vicons/fluent'\r\n\r\nimport axios from 'axios'\r\n\r\nimport { formatDate, mergeObject,createId } from '../../util/BaseUtil'\r\nimport QueryString from 'qs'\r\n\r\nconst global = inject('global')\r\n\r\n// 获取消息对象\r\nconst message = useMessage()\r\n// 获取弹框对象\r\nconst dialog = useDialog()\r\n\r\n// #region 数据查询\r\nconst findData = ref({\r\n  name: null,\r\n  phone: null,\r\n  dataRange: null,\r\n  visitingTime: computed(() => {\r\n    if (findData.value.dataRange != null) {\r\n      return formatDate(new Date(findData.value.dataRange[0]))\r\n    }\r\n    return null\r\n  }),\r\n  leaveTime: computed(() => {\r\n    if (findData.value.dataRange != null) {\r\n      return formatDate(new Date(findData.value.dataRange[1]))\r\n    }\r\n    return null\r\n  })\r\n})\r\n\r\n/**\r\n * 查询访客登记信息\r\n */\r\nconst findTouRegData = () => {\r\n  touRegPageChange(1)\r\n}\r\n\r\n/**\r\n * 重置查询数据\r\n */\r\nconst resetTouReg = () => {\r\n  findData.value.name = null\r\n  findData.value.phone = null\r\n  findData.value.dataRange = null\r\n}\r\n// #endregion\r\n\r\n// #region 加载访客登记信息\r\nconst touRegData = ref([]) // 访客登记信息数据\r\nconst pageNo = ref(1) // 当前页码\r\nconst pages = ref(1) // 总页数\r\nconst touRegLoading = ref(false) // 加载中\r\n/**\r\n * 加载访客登记信息\r\n */\r\nconst loadTouRegData = (more) => {\r\n  const params = {\r\n    page: 1,\r\n    size: global.pageSize\r\n  }\r\n  mergeObject(params, more, ['dataRange'])\r\n  touRegLoading.value = true\r\n  axios({\r\n    method: 'get',\r\n    url: global.api + '/getAllVisitorRecords',\r\n    params\r\n  }).then(res => {\r\n    pageNo.value = res.data.pageNo // 设置当前页码\r\n    pages.value = res.data.pages // 设置总页数\r\n    touRegData.value = res.data.list // 设置访客登记数据\r\n  }).catch(err => {\r\n    message.error('加载访客信息出现异常！' + err)\r\n  }).finally(() => {\r\n    touRegLoading.value = false\r\n  })\r\n}\r\nloadTouRegData()\r\n\r\n/**\r\n * 页码发生变化时触发\r\n * @param {页码} page \r\n */\r\nconst touRegPageChange = (page) => {\r\n  const more = {\r\n    page,\r\n  }\r\n  mergeObject(more, findData.value)\r\n  loadTouRegData(more)\r\n}\r\n\r\n// #endregion\r\n\r\n// #region 访客模态框\r\n\r\nconst showTouRegModal = ref(false) // 显示模态框\r\nconst touRegModalModel = ref(null) // 模态框模式\r\nconst touRegFormRef  = ref(null) // form 表单的引用\r\nconst submitTouRegLoading = ref(false) // 提交按钮加载\r\n\r\n// 性别数据\r\nconst touRegGender = ['女', '男'].map((k, v) => ({\r\n  label: k,\r\n  value: v\r\n}))\r\n\r\n/**\r\n * 访客数据\r\n */\r\nconst touRegValue = ref({\r\n  name: null,\r\n  gender: null,\r\n  phone: null,\r\n  carNo: null,\r\n  dataRange: null,\r\n  visitingTime: computed(() => {\r\n    if (touRegValue.value.dataRange != null) {\r\n      return formatDate(new Date(touRegValue.value.dataRange[0]))\r\n    }\r\n    return null\r\n  }),\r\n  leaveTime: computed(() => {\r\n    if (touRegValue.value.dataRange != null) {\r\n      return formatDate(new Date(touRegValue.value.dataRange[1]))\r\n    }\r\n    return null\r\n  }),\r\n  ownerNo: null,\r\n  type: null,\r\n  reason: null\r\n})\r\n\r\n/**\r\n * 访客数据校验\r\n */\r\nconst touRegRules = ref({\r\n  name: {\r\n    required: true,\r\n    message: \"请输入访客姓名\",\r\n    trigger: \"blur\"\r\n  },\r\n  gender: {\r\n    required: true,\r\n    type: 'number',\r\n    message: '请选择性别',\r\n    trigger: 'blur'\r\n  },\r\n  phone: {\r\n    required: true,\r\n    message: '请输入联系方式',\r\n    trigger: 'blur'\r\n  },\r\n  carNo: {\r\n    required: true,\r\n    message: '请输入车牌号',\r\n    trigger: 'blur'\r\n  },\r\n  dataRange: {\r\n    required: true,\r\n    type: 'array',\r\n    message: '请选择时间',\r\n    trigger: 'blur'\r\n  },\r\n  ownerNo: {\r\n    required: true,\r\n    message: '请选择目标业主',\r\n    trigger: 'blur'\r\n  },\r\n  type: {\r\n    required: true,\r\n    type: 'number',\r\n    message: '请选择事由类型',\r\n    trigger: 'blur'\r\n  },\r\n  reason: {\r\n    required: true,\r\n    message: '请输入拜访事由',\r\n    trigger: 'blur'\r\n  }\r\n})\r\n\r\n/**\r\n * 打开模态框\r\n */\r\nconst openTouRegModal = (model) => {\r\n  touRegModalModel.value = model\r\n  showTouRegModal.value = true\r\n}\r\n\r\n/**\r\n * 提交按钮\r\n */\r\nconst rouRegSubmit = (e) => {\r\n  e.preventDefault();\r\n  touRegFormRef.value?.validate((errors) => {\r\n    if (!errors) {\r\n      // 校验通过\r\n      if () {\r\n\r\n      }\r\n    } else {\r\n      // 校验不通过\r\n    }\r\n  });\r\n}\r\n\r\n// 添加访客信息\r\nconst addTouReg = () => {\r\n  touRegValue.value.visitorsNo = createId()\r\n  submitTouRegLoading.value = true\r\n  axios({\r\n    method: 'post',\r\n    url: global.api + '/addAppAnnouncement',\r\n    data: QueryString.stringify(touRegValue.value)\r\n  }).then(res => {\r\n    if (res.data.success) {\r\n      message.success('访客添加成功！')\r\n      // 刷新列表\r\n      touRegPageChange(pageNo.value)\r\n      showTouRegModal.value = false\r\n    } else {\r\n      message.warning('访客添加失败！')\r\n    }\r\n  }).catch(err => {\r\n    message.error('添加访客信息异常！' + err)\r\n  }).finally(() => {\r\n    submitTouRegLoading.value = false\r\n  })\r\n}\r\n\r\n// 事由数据\r\nconst reasonInfo = [\r\n  {\r\n    label: '喜事',\r\n    value: 1\r\n  },\r\n  {\r\n    label: '白事',\r\n    value: 0\r\n  }\r\n]\r\n// 目标业主信息\r\nconst targetOwnerInfo = ref([])\r\n// 目标业主加载中\r\nconst targetOwnerInfoLoading = ref(true)\r\n// 加载目标业主信息\r\naxios({\r\n  method: 'get',\r\n  url: global.api + 'getAllOwnerNoPaging',\r\n}).then(res => {\r\n  for (let owner of res.data) {\r\n    owner.label = owner.ownerNo + \" - \" + owner.name\r\n    owner.value = owner.ownerNo\r\n    targetOwnerInfo.value.push(owner)\r\n  }\r\n}).catch(err => {\r\n  message.error('目标业主信息加载异常！' + err)\r\n}).finally(() => {\r\n  targetOwnerInfoLoading.value = false\r\n})\r\n\r\n// #endregion\r\n\r\n</script>\r\n<script>\r\nexport default {\r\n  name: 'TouristRegistrationLayout'\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n\r\n</style>"]},"metadata":{},"sourceType":"module"}