{"ast":null,"code":"import { defineComponent, h, nextTick, ref, computed, watch, toRef } from 'vue';\nexport default defineComponent({\n  name: 'SlotMachineNumber',\n  props: {\n    clsPrefix: {\n      type: String,\n      required: true\n    },\n    value: {\n      // could be '+', 1, 2, ...\n      type: [Number, String],\n      required: true\n    },\n    oldOriginalNumber: {\n      type: Number,\n      default: undefined\n    },\n    newOriginalNumber: {\n      type: Number,\n      default: undefined\n    }\n  },\n\n  setup(props) {\n    const numberRef = ref(null);\n    const oldNumberRef = ref(props.value);\n    const newNumberRef = ref(props.value);\n    const scrollAnimationDirectionRef = ref('up');\n    const activeRef = ref(false);\n    const newNumberScrollAnimationClassRef = computed(() => {\n      return activeRef.value ? `${props.clsPrefix}-base-slot-machine-current-number--${scrollAnimationDirectionRef.value}-scroll` : null;\n    });\n    const oldNumberScrollAnimationClassRef = computed(() => {\n      return activeRef.value ? `${props.clsPrefix}-base-slot-machine-old-number--${scrollAnimationDirectionRef.value}-scroll` : null;\n    }); // BUG: may be typescript bug\n\n    watch(toRef(props, 'value'), (value, oldValue) => {\n      oldNumberRef.value = oldValue;\n      newNumberRef.value = value;\n      void nextTick(scroll);\n    });\n\n    function scroll() {\n      const newOriginalNumber = props.newOriginalNumber;\n      const oldOriginalNumber = props.oldOriginalNumber;\n\n      if (oldOriginalNumber === undefined || newOriginalNumber === undefined) {\n        return;\n      }\n\n      if (newOriginalNumber > oldOriginalNumber) {\n        scrollByDir('up');\n      } else if (oldOriginalNumber > newOriginalNumber) {\n        scrollByDir('down');\n      }\n    }\n\n    function scrollByDir(dir) {\n      scrollAnimationDirectionRef.value = dir;\n      activeRef.value = false;\n      void nextTick(() => {\n        var _a;\n\n        void ((_a = numberRef.value) === null || _a === void 0 ? void 0 : _a.offsetWidth);\n        activeRef.value = true;\n      });\n    }\n\n    return () => {\n      const {\n        clsPrefix\n      } = props;\n      return h(\"span\", {\n        ref: numberRef,\n        class: `${clsPrefix}-base-slot-machine-number`\n      }, oldNumberRef.value !== null ? h(\"span\", {\n        class: [`${clsPrefix}-base-slot-machine-old-number ${clsPrefix}-base-slot-machine-old-number--top`, oldNumberScrollAnimationClassRef.value]\n      }, oldNumberRef.value) : null, h(\"span\", {\n        class: [`${clsPrefix}-base-slot-machine-current-number`, newNumberScrollAnimationClassRef.value]\n      }, h(\"span\", {\n        ref: \"numberWrapper\",\n        class: [`${clsPrefix}-base-slot-machine-current-number__inner`, typeof props.value !== 'number' && `${clsPrefix}-base-slot-machine-current-number__inner--not-number`]\n      }, newNumberRef.value)), oldNumberRef.value !== null ? h(\"span\", {\n        class: [`${clsPrefix}-base-slot-machine-old-number ${clsPrefix}-base-slot-machine-old-number--bottom`, oldNumberScrollAnimationClassRef.value]\n      }, oldNumberRef.value) : null);\n    };\n  }\n\n});","map":{"version":3,"names":["defineComponent","h","nextTick","ref","computed","watch","toRef","name","props","clsPrefix","type","String","required","value","Number","oldOriginalNumber","default","undefined","newOriginalNumber","setup","numberRef","oldNumberRef","newNumberRef","scrollAnimationDirectionRef","activeRef","newNumberScrollAnimationClassRef","oldNumberScrollAnimationClassRef","oldValue","scroll","scrollByDir","dir","_a","offsetWidth","class"],"sources":["D:/VCode/SHC社区管理系统/shc_community_manager_system/node_modules/naive-ui/es/_internal/slot-machine/src/SlotMachineNumber.js"],"sourcesContent":["import { defineComponent, h, nextTick, ref, computed, watch, toRef } from 'vue';\nexport default defineComponent({\n    name: 'SlotMachineNumber',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        value: {\n            // could be '+', 1, 2, ...\n            type: [Number, String],\n            required: true\n        },\n        oldOriginalNumber: {\n            type: Number,\n            default: undefined\n        },\n        newOriginalNumber: {\n            type: Number,\n            default: undefined\n        }\n    },\n    setup(props) {\n        const numberRef = ref(null);\n        const oldNumberRef = ref(props.value);\n        const newNumberRef = ref(props.value);\n        const scrollAnimationDirectionRef = ref('up');\n        const activeRef = ref(false);\n        const newNumberScrollAnimationClassRef = computed(() => {\n            return activeRef.value\n                ? `${props.clsPrefix}-base-slot-machine-current-number--${scrollAnimationDirectionRef.value}-scroll`\n                : null;\n        });\n        const oldNumberScrollAnimationClassRef = computed(() => {\n            return activeRef.value\n                ? `${props.clsPrefix}-base-slot-machine-old-number--${scrollAnimationDirectionRef.value}-scroll`\n                : null;\n        });\n        // BUG: may be typescript bug\n        watch(toRef(props, 'value'), (value, oldValue) => {\n            oldNumberRef.value = oldValue;\n            newNumberRef.value = value;\n            void nextTick(scroll);\n        });\n        function scroll() {\n            const newOriginalNumber = props.newOriginalNumber;\n            const oldOriginalNumber = props.oldOriginalNumber;\n            if (oldOriginalNumber === undefined || newOriginalNumber === undefined) {\n                return;\n            }\n            if (newOriginalNumber > oldOriginalNumber) {\n                scrollByDir('up');\n            }\n            else if (oldOriginalNumber > newOriginalNumber) {\n                scrollByDir('down');\n            }\n        }\n        function scrollByDir(dir) {\n            scrollAnimationDirectionRef.value = dir;\n            activeRef.value = false;\n            void nextTick(() => {\n                var _a;\n                void ((_a = numberRef.value) === null || _a === void 0 ? void 0 : _a.offsetWidth);\n                activeRef.value = true;\n            });\n        }\n        return () => {\n            const { clsPrefix } = props;\n            return (h(\"span\", { ref: numberRef, class: `${clsPrefix}-base-slot-machine-number` },\n                oldNumberRef.value !== null ? (h(\"span\", { class: [\n                        `${clsPrefix}-base-slot-machine-old-number ${clsPrefix}-base-slot-machine-old-number--top`,\n                        oldNumberScrollAnimationClassRef.value\n                    ] }, oldNumberRef.value)) : null,\n                h(\"span\", { class: [\n                        `${clsPrefix}-base-slot-machine-current-number`,\n                        newNumberScrollAnimationClassRef.value\n                    ] },\n                    h(\"span\", { ref: \"numberWrapper\", class: [\n                            `${clsPrefix}-base-slot-machine-current-number__inner`,\n                            typeof props.value !== 'number' &&\n                                `${clsPrefix}-base-slot-machine-current-number__inner--not-number`\n                        ] }, newNumberRef.value)),\n                oldNumberRef.value !== null ? (h(\"span\", { class: [\n                        `${clsPrefix}-base-slot-machine-old-number ${clsPrefix}-base-slot-machine-old-number--bottom`,\n                        oldNumberScrollAnimationClassRef.value\n                    ] }, oldNumberRef.value)) : null));\n        };\n    }\n});\n"],"mappings":"AAAA,SAASA,eAAT,EAA0BC,CAA1B,EAA6BC,QAA7B,EAAuCC,GAAvC,EAA4CC,QAA5C,EAAsDC,KAAtD,EAA6DC,KAA7D,QAA0E,KAA1E;AACA,eAAeN,eAAe,CAAC;EAC3BO,IAAI,EAAE,mBADqB;EAE3BC,KAAK,EAAE;IACHC,SAAS,EAAE;MACPC,IAAI,EAAEC,MADC;MAEPC,QAAQ,EAAE;IAFH,CADR;IAKHC,KAAK,EAAE;MACH;MACAH,IAAI,EAAE,CAACI,MAAD,EAASH,MAAT,CAFH;MAGHC,QAAQ,EAAE;IAHP,CALJ;IAUHG,iBAAiB,EAAE;MACfL,IAAI,EAAEI,MADS;MAEfE,OAAO,EAAEC;IAFM,CAVhB;IAcHC,iBAAiB,EAAE;MACfR,IAAI,EAAEI,MADS;MAEfE,OAAO,EAAEC;IAFM;EAdhB,CAFoB;;EAqB3BE,KAAK,CAACX,KAAD,EAAQ;IACT,MAAMY,SAAS,GAAGjB,GAAG,CAAC,IAAD,CAArB;IACA,MAAMkB,YAAY,GAAGlB,GAAG,CAACK,KAAK,CAACK,KAAP,CAAxB;IACA,MAAMS,YAAY,GAAGnB,GAAG,CAACK,KAAK,CAACK,KAAP,CAAxB;IACA,MAAMU,2BAA2B,GAAGpB,GAAG,CAAC,IAAD,CAAvC;IACA,MAAMqB,SAAS,GAAGrB,GAAG,CAAC,KAAD,CAArB;IACA,MAAMsB,gCAAgC,GAAGrB,QAAQ,CAAC,MAAM;MACpD,OAAOoB,SAAS,CAACX,KAAV,GACA,GAAEL,KAAK,CAACC,SAAU,sCAAqCc,2BAA2B,CAACV,KAAM,SADzF,GAED,IAFN;IAGH,CAJgD,CAAjD;IAKA,MAAMa,gCAAgC,GAAGtB,QAAQ,CAAC,MAAM;MACpD,OAAOoB,SAAS,CAACX,KAAV,GACA,GAAEL,KAAK,CAACC,SAAU,kCAAiCc,2BAA2B,CAACV,KAAM,SADrF,GAED,IAFN;IAGH,CAJgD,CAAjD,CAXS,CAgBT;;IACAR,KAAK,CAACC,KAAK,CAACE,KAAD,EAAQ,OAAR,CAAN,EAAwB,CAACK,KAAD,EAAQc,QAAR,KAAqB;MAC9CN,YAAY,CAACR,KAAb,GAAqBc,QAArB;MACAL,YAAY,CAACT,KAAb,GAAqBA,KAArB;MACA,KAAKX,QAAQ,CAAC0B,MAAD,CAAb;IACH,CAJI,CAAL;;IAKA,SAASA,MAAT,GAAkB;MACd,MAAMV,iBAAiB,GAAGV,KAAK,CAACU,iBAAhC;MACA,MAAMH,iBAAiB,GAAGP,KAAK,CAACO,iBAAhC;;MACA,IAAIA,iBAAiB,KAAKE,SAAtB,IAAmCC,iBAAiB,KAAKD,SAA7D,EAAwE;QACpE;MACH;;MACD,IAAIC,iBAAiB,GAAGH,iBAAxB,EAA2C;QACvCc,WAAW,CAAC,IAAD,CAAX;MACH,CAFD,MAGK,IAAId,iBAAiB,GAAGG,iBAAxB,EAA2C;QAC5CW,WAAW,CAAC,MAAD,CAAX;MACH;IACJ;;IACD,SAASA,WAAT,CAAqBC,GAArB,EAA0B;MACtBP,2BAA2B,CAACV,KAA5B,GAAoCiB,GAApC;MACAN,SAAS,CAACX,KAAV,GAAkB,KAAlB;MACA,KAAKX,QAAQ,CAAC,MAAM;QAChB,IAAI6B,EAAJ;;QACA,MAAM,CAACA,EAAE,GAAGX,SAAS,CAACP,KAAhB,MAA2B,IAA3B,IAAmCkB,EAAE,KAAK,KAAK,CAA/C,GAAmD,KAAK,CAAxD,GAA4DA,EAAE,CAACC,WAArE;QACAR,SAAS,CAACX,KAAV,GAAkB,IAAlB;MACH,CAJY,CAAb;IAKH;;IACD,OAAO,MAAM;MACT,MAAM;QAAEJ;MAAF,IAAgBD,KAAtB;MACA,OAAQP,CAAC,CAAC,MAAD,EAAS;QAAEE,GAAG,EAAEiB,SAAP;QAAkBa,KAAK,EAAG,GAAExB,SAAU;MAAtC,CAAT,EACLY,YAAY,CAACR,KAAb,KAAuB,IAAvB,GAA+BZ,CAAC,CAAC,MAAD,EAAS;QAAEgC,KAAK,EAAE,CACzC,GAAExB,SAAU,iCAAgCA,SAAU,oCADb,EAE1CiB,gCAAgC,CAACb,KAFS;MAAT,CAAT,EAGvBQ,YAAY,CAACR,KAHU,CAAhC,GAGgC,IAJ3B,EAKLZ,CAAC,CAAC,MAAD,EAAS;QAAEgC,KAAK,EAAE,CACV,GAAExB,SAAU,mCADF,EAEXgB,gCAAgC,CAACZ,KAFtB;MAAT,CAAT,EAIGZ,CAAC,CAAC,MAAD,EAAS;QAAEE,GAAG,EAAE,eAAP;QAAwB8B,KAAK,EAAE,CAChC,GAAExB,SAAU,0CADoB,EAEjC,OAAOD,KAAK,CAACK,KAAb,KAAuB,QAAvB,IACK,GAAEJ,SAAU,sDAHgB;MAA/B,CAAT,EAIQa,YAAY,CAACT,KAJrB,CAJJ,CALI,EAcLQ,YAAY,CAACR,KAAb,KAAuB,IAAvB,GAA+BZ,CAAC,CAAC,MAAD,EAAS;QAAEgC,KAAK,EAAE,CACzC,GAAExB,SAAU,iCAAgCA,SAAU,uCADb,EAE1CiB,gCAAgC,CAACb,KAFS;MAAT,CAAT,EAGvBQ,YAAY,CAACR,KAHU,CAAhC,GAGgC,IAjB3B,CAAT;IAkBH,CApBD;EAqBH;;AAtF0B,CAAD,CAA9B"},"metadata":{},"sourceType":"module"}