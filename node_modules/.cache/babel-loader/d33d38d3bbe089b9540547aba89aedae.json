{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { defineComponent, Fragment, ref, h, provide, reactive } from 'vue';\nimport { createId } from 'seemly';\nimport { useClicked, useClickPosition } from 'vooks';\nimport { omit } from '../../_utils';\nimport { NDialogEnvironment } from './DialogEnvironment';\nimport { dialogApiInjectionKey, dialogProviderInjectionKey, dialogReactiveListInjectionKey } from './context';\nexport const dialogProviderProps = {\n  injectionKey: String,\n  to: [String, Object]\n};\nexport const NDialogProvider = defineComponent({\n  name: 'DialogProvider',\n  props: dialogProviderProps,\n\n  setup() {\n    const dialogListRef = ref([]);\n    const dialogInstRefs = {};\n\n    function create(options = {}) {\n      const key = createId();\n      const dialogReactive = reactive(Object.assign(Object.assign({}, options), {\n        key,\n        destroy: () => {\n          dialogInstRefs[`n-dialog-${key}`].hide();\n        }\n      }));\n      dialogListRef.value.push(dialogReactive);\n      return dialogReactive;\n    }\n\n    const typedApi = ['info', 'success', 'warning', 'error'].map(type => options => {\n      return create(Object.assign(Object.assign({}, options), {\n        type\n      }));\n    });\n\n    function handleAfterLeave(key) {\n      const {\n        value: dialogList\n      } = dialogListRef;\n      dialogList.splice(dialogList.findIndex(dialog => dialog.key === key), 1);\n    }\n\n    function destroyAll() {\n      Object.values(dialogInstRefs).forEach(dialogInstRef => dialogInstRef.hide());\n    }\n\n    const api = {\n      create,\n      destroyAll,\n      info: typedApi[0],\n      success: typedApi[1],\n      warning: typedApi[2],\n      error: typedApi[3]\n    };\n    provide(dialogApiInjectionKey, api);\n    provide(dialogProviderInjectionKey, {\n      clickedRef: useClicked(64),\n      clickPositionRef: useClickPosition()\n    });\n    provide(dialogReactiveListInjectionKey, dialogListRef);\n    return Object.assign(Object.assign({}, api), {\n      dialogList: dialogListRef,\n      dialogInstRefs,\n      handleAfterLeave\n    });\n  },\n\n  render() {\n    var _a, _b;\n\n    return h(Fragment, null, [this.dialogList.map(dialog => h(NDialogEnvironment, omit(dialog, ['destroy', 'style'], {\n      internalStyle: dialog.style,\n      to: this.to,\n      ref: inst => {\n        if (inst === null) {\n          // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n          delete this.dialogInstRefs[`n-dialog-${dialog.key}`];\n        } else {\n          this.dialogInstRefs[`n-dialog-${dialog.key}`] = inst;\n        }\n      },\n      internalKey: dialog.key,\n      onInternalAfterLeave: this.handleAfterLeave\n    }))), (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a)]);\n  }\n\n});","map":{"version":3,"names":["defineComponent","Fragment","ref","h","provide","reactive","createId","useClicked","useClickPosition","omit","NDialogEnvironment","dialogApiInjectionKey","dialogProviderInjectionKey","dialogReactiveListInjectionKey","dialogProviderProps","injectionKey","String","to","Object","NDialogProvider","name","props","setup","dialogListRef","dialogInstRefs","create","options","key","dialogReactive","assign","destroy","hide","value","push","typedApi","map","type","handleAfterLeave","dialogList","splice","findIndex","dialog","destroyAll","values","forEach","dialogInstRef","api","info","success","warning","error","clickedRef","clickPositionRef","render","_a","_b","internalStyle","style","inst","internalKey","onInternalAfterLeave","$slots","default","call"],"sources":["D:/VCode/SHC社区管理系统/shc_community_manager_system/node_modules/naive-ui/es/dialog/src/DialogProvider.js"],"sourcesContent":["import { defineComponent, Fragment, ref, h, provide, reactive } from 'vue';\nimport { createId } from 'seemly';\nimport { useClicked, useClickPosition } from 'vooks';\nimport { omit } from '../../_utils';\nimport { NDialogEnvironment } from './DialogEnvironment';\nimport { dialogApiInjectionKey, dialogProviderInjectionKey, dialogReactiveListInjectionKey } from './context';\nexport const dialogProviderProps = {\n    injectionKey: String,\n    to: [String, Object]\n};\nexport const NDialogProvider = defineComponent({\n    name: 'DialogProvider',\n    props: dialogProviderProps,\n    setup() {\n        const dialogListRef = ref([]);\n        const dialogInstRefs = {};\n        function create(options = {}) {\n            const key = createId();\n            const dialogReactive = reactive(Object.assign(Object.assign({}, options), { key, destroy: () => {\n                    dialogInstRefs[`n-dialog-${key}`].hide();\n                } }));\n            dialogListRef.value.push(dialogReactive);\n            return dialogReactive;\n        }\n        const typedApi = ['info', 'success', 'warning', 'error'].map((type) => (options) => {\n            return create(Object.assign(Object.assign({}, options), { type }));\n        });\n        function handleAfterLeave(key) {\n            const { value: dialogList } = dialogListRef;\n            dialogList.splice(dialogList.findIndex((dialog) => dialog.key === key), 1);\n        }\n        function destroyAll() {\n            Object.values(dialogInstRefs).forEach((dialogInstRef) => dialogInstRef.hide());\n        }\n        const api = {\n            create,\n            destroyAll,\n            info: typedApi[0],\n            success: typedApi[1],\n            warning: typedApi[2],\n            error: typedApi[3]\n        };\n        provide(dialogApiInjectionKey, api);\n        provide(dialogProviderInjectionKey, {\n            clickedRef: useClicked(64),\n            clickPositionRef: useClickPosition()\n        });\n        provide(dialogReactiveListInjectionKey, dialogListRef);\n        return Object.assign(Object.assign({}, api), { dialogList: dialogListRef, dialogInstRefs,\n            handleAfterLeave });\n    },\n    render() {\n        var _a, _b;\n        return h(Fragment, null, [\n            this.dialogList.map((dialog) => h(NDialogEnvironment, omit(dialog, ['destroy', 'style'], {\n                internalStyle: dialog.style,\n                to: this.to,\n                ref: ((inst) => {\n                    if (inst === null) {\n                        // eslint-disable-next-line @typescript-eslint/no-dynamic-delete\n                        delete this.dialogInstRefs[`n-dialog-${dialog.key}`];\n                    }\n                    else {\n                        this.dialogInstRefs[`n-dialog-${dialog.key}`] = inst;\n                    }\n                }),\n                internalKey: dialog.key,\n                onInternalAfterLeave: this.handleAfterLeave\n            }))),\n            (_b = (_a = this.$slots).default) === null || _b === void 0 ? void 0 : _b.call(_a)\n        ]);\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}