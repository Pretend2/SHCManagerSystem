{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, reactive } from 'vue';\nimport { useMessage, useDialog } from 'naive-ui';\nimport axios from 'axios';\nexport default (() => {\n  const message = useMessage();\n  const dialog = useDialog();\n  const leftSpin = ref(false); // 楼栋 模态框\n\n  const buildingStatus = ref(false); // false 添加 true 修改\n\n  const buildingFormRef = ref(null);\n  const showBuildingModal = ref(false); // 模态框是否打开\n  // 表单校验\n\n  const buildingRules = {\n    id: {\n      required: true,\n      message: \"请输入楼栋编号\",\n      trigger: \"blur\"\n    },\n    name: {\n      required: true,\n      message: \"请输入楼栋名称\",\n      trigger: \"blur\"\n    },\n    area: {\n      required: true,\n      message: \"请输入建筑面积\",\n      trigger: \"blur\"\n    }\n  }; // 表单输入数据\n\n  const buildingValue = ref({\n    id: \"\",\n    name: \"\",\n    area: \"\",\n    remark: \"\"\n  }); // 表单提交事件\n\n  const buildingSubmit = e => {\n    e.preventDefault();\n    buildingFormRef.value?.validate(errors => {\n      if (!errors) {// 校验通过\n      } else {// 校验不通过\n      }\n    });\n  }; // 删除楼栋\n\n\n  const deleteBuilding = id => {\n    dialog.warning({\n      title: \"请确认您的操作!\",\n      content: \"确认是否删除!\",\n      positiveText: \"确认删除\",\n      negativeText: \"取消\",\n      onPositiveClick: () => {\n        message.success(\"确认删除 => \" + id);\n      }\n    });\n  }; // 楼栋信息\n\n\n  const buildingData = reactive([]);\n  /* \r\n  \r\n  [{\r\n      \"label\": \"1栋\",\r\n      \"type\": 0,\r\n      \"key\": \"403626\",\r\n      \"children\": [\r\n        {\r\n          \"label\": \"1单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362610\"\r\n        },\r\n        {\r\n          \"label\": \"2单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362611\"\r\n        },\r\n        {\r\n          \"label\": \"6单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362612\"\r\n        },\r\n        {\r\n          \"label\": \"12单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362613\"\r\n        }\r\n      ]\r\n    }, {\r\n      \"label\": \"2栋\",\r\n      \"type\": 0,\r\n      \"key\": \"403627\",\r\n      \"children\": [\r\n        {\r\n          \"label\": \"1单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362614\"\r\n        },\r\n        {\r\n          \"label\": \"2单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362615\"\r\n        },\r\n        {\r\n          \"label\": \"6单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362616\"\r\n        },\r\n        {\r\n          \"label\": \"12单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362617\"\r\n        }\r\n      ]\r\n    }, , {\r\n      \"label\": \"3栋\",\r\n      \"type\": 0,\r\n      \"key\": \"403628\",\r\n      \"children\": [\r\n        {\r\n          \"label\": \"1单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362618\"\r\n        },\r\n        {\r\n          \"label\": \"2单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362619\"\r\n        },\r\n        {\r\n          \"label\": \"6单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362620\"\r\n        },\r\n        {\r\n          \"label\": \"12单元\",\r\n          \"type\": 1,\r\n          \"key\": \"40362621\"\r\n        }\r\n      ]\r\n    }]\r\n  */\n  // 加载楼栋信息\n\n  leftSpin.value = true; // 加载楼栋信息\n\n  axios({\n    method: 'get',\n    url: '/api/getAllBuildings'\n  }).then(res => {\n    for (let building of res.data) {\n      const tempData = reactive({\n        \"id\": building.buildingNo,\n        \"label\": building.name,\n        \"type\": 0,\n        \"key\": \"L\" + building.id,\n        \"children\": []\n      });\n      leftSpin.value = true;\n      axios({\n        method: 'get',\n        url: '/api/getAllByBuildingNoUnits/' + building.buildingNo\n      }).then(res => {\n        for (let unit of res.data) {\n          tempData.children.push({\n            \"id\": unit.utilNo,\n            \"label\": unit.utilNo + \"单元\",\n            \"type\": 1,\n            \"key\": \"D\" + unit.id,\n            \"building\": {\n              \"id\": building.buildingNo,\n              \"label\": building.name,\n              \"type\": 0,\n              \"key\": \"L\" + building.id\n            }\n          });\n        }\n\n        leftSpin.value = false;\n      }).catch(err => {\n        message.error('加载出现异常！' + err);\n        leftSpin.value = false;\n      });\n      buildingData.push(tempData);\n    }\n  }).catch(err => {\n    leftSpin.value = false;\n    message.error('数据加载异常！' + err, {\n      duration: 5000\n    });\n  }); // 楼栋节点点击事件\n\n  function nodeProps({\n    option\n  }) {\n    return {\n      onClick() {\n        if (option.type === 0) {// 楼栋被点击\n        } else if (option.type === 1) {\n          // 单元被点击\n          console.log(option);\n        }\n      }\n\n    };\n  }\n\n  function loadList(option) {\n    axios({\n      method: 'get',\n      url: '/api/getAllHouses',\n      params: {\n        buildingNo: option,\n        utilNo,\n        page,\n        size\n      }\n    });\n  }\n\n  return {\n    buildingStatus,\n    buildingFormRef,\n    showBuildingModal,\n    buildingRules,\n    buildingValue,\n    buildingData,\n    leftSpin,\n    buildingSubmit,\n    nodeProps,\n    deleteBuilding\n  };\n});","map":{"version":3,"names":["ref","reactive","useMessage","useDialog","axios","message","dialog","leftSpin","buildingStatus","buildingFormRef","showBuildingModal","buildingRules","id","required","trigger","name","area","buildingValue","remark","buildingSubmit","e","preventDefault","value","validate","errors","deleteBuilding","warning","title","content","positiveText","negativeText","onPositiveClick","success","buildingData","method","url","then","res","building","data","tempData","buildingNo","unit","children","push","utilNo","catch","err","error","duration","nodeProps","option","onClick","type","console","log","loadList","params","page","size"],"sources":["E:/VCode/SHC社区管理系统/shc_community_manager_system/src/hook/real_estate/housingmanagement/buildingHook.js"],"sourcesContent":["import { ref, reactive } from 'vue'\r\n\r\nimport { useMessage, useDialog } from 'naive-ui'\r\n\r\nimport axios from 'axios'\r\n\r\nexport default () => {\r\n\r\n    const message = useMessage();\r\n    const dialog = useDialog();\r\n\r\n    const leftSpin = ref(false)\r\n\r\n    // 楼栋 模态框\r\n    const buildingStatus = ref(false); // false 添加 true 修改\r\n    const buildingFormRef = ref(null);\r\n    const showBuildingModal = ref(false) // 模态框是否打开\r\n    // 表单校验\r\n    const buildingRules = {\r\n        id: {\r\n            required: true,\r\n            message: \"请输入楼栋编号\",\r\n            trigger: \"blur\"\r\n        },\r\n        name: {\r\n            required: true,\r\n            message: \"请输入楼栋名称\",\r\n            trigger: \"blur\"\r\n        },\r\n        area: {\r\n            required: true,\r\n            message: \"请输入建筑面积\",\r\n            trigger: \"blur\"\r\n        },\r\n    }\r\n\r\n    // 表单输入数据\r\n    const buildingValue = ref({\r\n        id: \"\",\r\n        name: \"\",\r\n        area: \"\",\r\n        remark: \"\",\r\n    })\r\n\r\n    // 表单提交事件\r\n    const buildingSubmit = (e) => {\r\n        e.preventDefault();\r\n        buildingFormRef.value?.validate((errors) => {\r\n            if (!errors) {\r\n                // 校验通过\r\n            } else {\r\n                // 校验不通过\r\n            }\r\n        });\r\n    }\r\n\r\n    // 删除楼栋\r\n    const deleteBuilding = (id) => {\r\n        dialog.warning({\r\n            title: \"请确认您的操作!\",\r\n            content: \"确认是否删除!\",\r\n            positiveText: \"确认删除\",\r\n            negativeText: \"取消\",\r\n            onPositiveClick: () => {\r\n                message.success(\"确认删除 => \" + id);\r\n            }\r\n        });\r\n    }\r\n\r\n    // 楼栋信息\r\n    const buildingData = reactive([])\r\n\r\n    /* \r\n    \r\n    [{\r\n        \"label\": \"1栋\",\r\n        \"type\": 0,\r\n        \"key\": \"403626\",\r\n        \"children\": [\r\n          {\r\n            \"label\": \"1单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362610\"\r\n          },\r\n          {\r\n            \"label\": \"2单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362611\"\r\n          },\r\n          {\r\n            \"label\": \"6单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362612\"\r\n          },\r\n          {\r\n            \"label\": \"12单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362613\"\r\n          }\r\n        ]\r\n      }, {\r\n        \"label\": \"2栋\",\r\n        \"type\": 0,\r\n        \"key\": \"403627\",\r\n        \"children\": [\r\n          {\r\n            \"label\": \"1单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362614\"\r\n          },\r\n          {\r\n            \"label\": \"2单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362615\"\r\n          },\r\n          {\r\n            \"label\": \"6单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362616\"\r\n          },\r\n          {\r\n            \"label\": \"12单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362617\"\r\n          }\r\n        ]\r\n      }, , {\r\n        \"label\": \"3栋\",\r\n        \"type\": 0,\r\n        \"key\": \"403628\",\r\n        \"children\": [\r\n          {\r\n            \"label\": \"1单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362618\"\r\n          },\r\n          {\r\n            \"label\": \"2单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362619\"\r\n          },\r\n          {\r\n            \"label\": \"6单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362620\"\r\n          },\r\n          {\r\n            \"label\": \"12单元\",\r\n            \"type\": 1,\r\n            \"key\": \"40362621\"\r\n          }\r\n        ]\r\n      }]\r\n    */\r\n\r\n    // 加载楼栋信息\r\n    leftSpin.value = true\r\n    // 加载楼栋信息\r\n    axios({\r\n        method: 'get',\r\n        url: '/api/getAllBuildings',\r\n    }).then(res => {\r\n        for (let building of res.data) {\r\n            const tempData = reactive({\r\n                \"id\": building.buildingNo,\r\n                \"label\": building.name,\r\n                \"type\": 0,\r\n                \"key\": \"L\" + building.id,\r\n                \"children\": []\r\n            })\r\n\r\n            leftSpin.value = true\r\n            axios({\r\n                method: 'get',\r\n                url: '/api/getAllByBuildingNoUnits/' + building.buildingNo,\r\n            }).then(res => {\r\n                for (let unit of res.data) {\r\n                    tempData.children.push({\r\n                        \"id\": unit.utilNo,\r\n                        \"label\": unit.utilNo + \"单元\",\r\n                        \"type\": 1,\r\n                        \"key\": \"D\" + unit.id,\r\n                        \"building\": {\r\n                            \"id\": building.buildingNo,\r\n                            \"label\": building.name,\r\n                            \"type\": 0,\r\n                            \"key\": \"L\" + building.id\r\n                        }\r\n                    })\r\n                }\r\n                leftSpin.value = false\r\n            }).catch(err => {\r\n                message.error('加载出现异常！' + err)\r\n                leftSpin.value = false\r\n            })\r\n            buildingData.push(tempData);\r\n        }\r\n    }).catch(err => {\r\n        leftSpin.value = false\r\n        message.error('数据加载异常！' + err, { duration: 5000 })\r\n    })\r\n\r\n    // 楼栋节点点击事件\r\n    function nodeProps({ option }) {\r\n        return {\r\n            onClick() {\r\n                if (option.type === 0) { // 楼栋被点击\r\n                } else if (option.type === 1) { // 单元被点击\r\n                    console.log(option);\r\n                }\r\n            }\r\n        };\r\n    }\r\n\r\n    function loadList(option) {\r\n        axios({\r\n            method: 'get',\r\n            url: '/api/getAllHouses',\r\n            params: {\r\n                buildingNo: option,\r\n                utilNo,\r\n                page,\r\n                size\r\n            }\r\n        })\r\n    }\r\n\r\n    return {\r\n        buildingStatus,\r\n        buildingFormRef,\r\n        showBuildingModal,\r\n        buildingRules,\r\n        buildingValue,\r\n        buildingData,\r\n        leftSpin,\r\n        buildingSubmit,\r\n        nodeProps,\r\n        deleteBuilding,\r\n    }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}