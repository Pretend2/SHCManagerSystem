{"ast":null,"code":"/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { ref, readonly, onBeforeMount, onBeforeUnmount } from 'vue';\nimport { hasInstance } from './utils';\nlet usedCount = 0; // Mql means media query list\n\nconst supportMatchMedia = typeof window !== 'undefined' && window.matchMedia !== undefined;\nconst osTheme = ref(null);\nlet darkMql;\nlet lightMql;\n\nfunction handleDarkMqlChange(e) {\n  if (e.matches) {\n    osTheme.value = 'dark';\n  }\n}\n\nfunction handleLightMqlChange(e) {\n  if (e.matches) {\n    osTheme.value = 'light';\n  }\n}\n\nfunction init() {\n  darkMql = window.matchMedia('(prefers-color-scheme: dark)');\n  lightMql = window.matchMedia('(prefers-color-scheme: light)');\n\n  if (darkMql.matches) {\n    osTheme.value = 'dark';\n  } else if (lightMql.matches) {\n    osTheme.value = 'light';\n  } else {\n    osTheme.value = null;\n  }\n\n  if (darkMql.addEventListener) {\n    darkMql.addEventListener('change', handleDarkMqlChange);\n    lightMql.addEventListener('change', handleLightMqlChange);\n  } else if (darkMql.addListener) {\n    darkMql.addListener(handleDarkMqlChange);\n    lightMql.addListener(handleLightMqlChange);\n  }\n}\n\nfunction clean() {\n  if ('removeEventListener' in darkMql) {\n    darkMql.removeEventListener('change', handleDarkMqlChange);\n    lightMql.removeEventListener('change', handleLightMqlChange);\n  } else if ('removeListener' in darkMql) {\n    darkMql.removeListener(handleDarkMqlChange);\n    lightMql.removeListener(handleLightMqlChange);\n  }\n\n  darkMql = undefined;\n  lightMql = undefined;\n}\n\nlet managable = true;\nexport default function useOsTheme() {\n  /* istanbul ignore next */\n  if (process.env.NODE_ENV !== 'test' && !supportMatchMedia) {\n    return readonly(osTheme);\n  }\n\n  if (process.env.NODE_ENV === 'test' && window.matchMedia === undefined) {\n    return readonly(osTheme);\n  }\n\n  if (usedCount === 0) init();\n\n  if (managable && (managable = hasInstance())) {\n    onBeforeMount(() => {\n      usedCount += 1;\n    });\n    onBeforeUnmount(() => {\n      usedCount -= 1;\n      if (usedCount === 0) clean();\n    });\n  }\n\n  return readonly(osTheme);\n}","map":{"version":3,"names":["ref","readonly","onBeforeMount","onBeforeUnmount","hasInstance","usedCount","supportMatchMedia","window","matchMedia","undefined","osTheme","darkMql","lightMql","handleDarkMqlChange","e","matches","value","handleLightMqlChange","init","addEventListener","addListener","clean","removeEventListener","removeListener","managable","useOsTheme","process","env","NODE_ENV"],"sources":["E:/VCode/SHC社区管理系统/shc_community_manager_system/node_modules/vooks/es/use-os-theme.js"],"sourcesContent":["/* eslint-disable @typescript-eslint/strict-boolean-expressions */\n/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { ref, readonly, onBeforeMount, onBeforeUnmount } from 'vue';\nimport { hasInstance } from './utils';\nlet usedCount = 0;\n// Mql means media query list\nconst supportMatchMedia = typeof window !== 'undefined' && window.matchMedia !== undefined;\nconst osTheme = ref(null);\nlet darkMql;\nlet lightMql;\nfunction handleDarkMqlChange(e) {\n    if (e.matches) {\n        osTheme.value = 'dark';\n    }\n}\nfunction handleLightMqlChange(e) {\n    if (e.matches) {\n        osTheme.value = 'light';\n    }\n}\nfunction init() {\n    darkMql = window.matchMedia('(prefers-color-scheme: dark)');\n    lightMql = window.matchMedia('(prefers-color-scheme: light)');\n    if (darkMql.matches) {\n        osTheme.value = 'dark';\n    }\n    else if (lightMql.matches) {\n        osTheme.value = 'light';\n    }\n    else {\n        osTheme.value = null;\n    }\n    if (darkMql.addEventListener) {\n        darkMql.addEventListener('change', handleDarkMqlChange);\n        lightMql.addEventListener('change', handleLightMqlChange);\n    }\n    else if (darkMql.addListener) {\n        darkMql.addListener(handleDarkMqlChange);\n        lightMql.addListener(handleLightMqlChange);\n    }\n}\nfunction clean() {\n    if ('removeEventListener' in darkMql) {\n        darkMql.removeEventListener('change', handleDarkMqlChange);\n        lightMql.removeEventListener('change', handleLightMqlChange);\n    }\n    else if ('removeListener' in darkMql) {\n        darkMql.removeListener(handleDarkMqlChange);\n        lightMql.removeListener(handleLightMqlChange);\n    }\n    darkMql = undefined;\n    lightMql = undefined;\n}\nlet managable = true;\nexport default function useOsTheme() {\n    /* istanbul ignore next */\n    if (process.env.NODE_ENV !== 'test' && !supportMatchMedia) {\n        return readonly(osTheme);\n    }\n    if (process.env.NODE_ENV === 'test' && window.matchMedia === undefined) {\n        return readonly(osTheme);\n    }\n    if (usedCount === 0)\n        init();\n    if (managable && (managable = hasInstance())) {\n        onBeforeMount(() => {\n            usedCount += 1;\n        });\n        onBeforeUnmount(() => {\n            usedCount -= 1;\n            if (usedCount === 0)\n                clean();\n        });\n    }\n    return readonly(osTheme);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}