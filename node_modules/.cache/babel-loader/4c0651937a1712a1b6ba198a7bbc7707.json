{"ast":null,"code":"// 添加业主\nimport { ref, inject } from 'vue';\nimport { useMessage } from 'naive-ui';\nimport QueryString from 'qs';\nimport axios from 'axios';\nimport { createId } from '../../../util/BaseUtil';\nexport default (refreshOwnerData => {\n  // 接收全局变量\n  const global = inject(\"global\"); // 获取消息对象\n\n  const message = useMessage(); // 业主 模态框\n\n  const ownerStatus = ref(false); // false 添加 true 修改\n\n  const ownerFormRef = ref(null); // 业主 Form 引用\n\n  const showOwnerModal = ref(false); // 模态框是否打开\n  // 表单校验\n\n  const ownerRules = {\n    user: {\n      name: {\n        required: true,\n        message: \"请输入姓名\",\n        trigger: \"blur\"\n      },\n      gender: {\n        type: \"number\",\n        required: true,\n        message: \"请选择性别\",\n        trigger: \"blur\"\n      },\n      age: {\n        required: true,\n        message: \"请输入年龄\",\n        trigger: \"blur\"\n      },\n      phone: {\n        required: true,\n        message: \"请输入手机号码\",\n        trigger: \"blur\"\n      }\n    }\n  }; // 表单输入数据\n\n  const ownerformValue = ref({\n    user: {\n      name: \"\",\n      gender: null,\n      age: \"\",\n      idCard: \"\",\n      phone: \"\",\n      remark: \"\",\n      weCat: \"\",\n      isMember: 0\n    }\n  }); // 表单提交事件\n\n  const addownerSubmit = e => {\n    e.preventDefault();\n    ownerFormRef.value?.validate(errors => {\n      if (!errors) {\n        // 校验通过\n        if (!ownerStatus.value) {\n          // 添加\n          addOwner();\n        } else {// 修改\n        }\n      } else {// 校验不通过\n      }\n    });\n  }; // 业主添加加载\n\n\n  const addOwnerLoading = ref(false);\n  /**\r\n   * 添加业主\r\n   */\n\n  const addOwner = () => {\n    addOwnerLoading.value = true;\n    ownerformValue.value.user.ownerNo = createId();\n    console.log(ownerformValue.value.user);\n    console.log(QueryString.stringify(ownerformValue.value.user));\n    axios({\n      method: 'post',\n      url: global.api + '/addOwner',\n      data: QueryString.stringify(ownerformValue.value.user)\n    }).then(res => {\n      console.log(res);\n\n      if (res.data.success) {\n        message.success(\"添加成功！\");\n        refreshOwnerData(); // 刷新业主数据\n      } else {\n        message.warning(\"添加失败！\");\n      }\n    }).catch(err => {\n      message.error(\"添加业主出现异常！\" + err);\n    }).finally(() => {\n      addOwnerLoading.value = false;\n    });\n  }; // 性别选择框数据\n\n\n  const ownerGenderOptions = ref(['男', '女'].map((v, i) => ({\n    label: v,\n    value: i\n  })));\n  /**\r\n   * 打开模态框\r\n   * @param {false 添加 true 修改} status\r\n   */\n\n  const openOwnerModal = status => {\n    showOwnerModal.value = true;\n    ownerStatus.value = status;\n  };\n  /**\r\n   * 关闭模态框\r\n   */\n\n\n  const closeOwnerModal = () => {\n    showOwnerModal.value = false;\n  };\n\n  return {\n    ownerStatus,\n    // 模态 添加 or 修改 框状态\n    ownerFormRef,\n    // 业主 Form 引用\n    showOwnerModal,\n    // 显示模态框\n    ownerRules,\n    // 表单校验\n    ownerformValue,\n    // 表单参数\n    ownerGenderOptions,\n    // 性别选项数据\n    addOwnerLoading,\n    // 业主添加加载\n    openOwnerModal,\n    // 打开模态框\n    closeOwnerModal,\n    // 关闭模态框\n    addownerSubmit // 表单提交\n\n  };\n});","map":{"version":3,"names":["ref","inject","useMessage","QueryString","axios","createId","refreshOwnerData","global","message","ownerStatus","ownerFormRef","showOwnerModal","ownerRules","user","name","required","trigger","gender","type","age","phone","ownerformValue","idCard","remark","weCat","isMember","addownerSubmit","e","preventDefault","value","validate","errors","addOwner","addOwnerLoading","ownerNo","console","log","stringify","method","url","api","data","then","res","success","warning","catch","err","error","finally","ownerGenderOptions","map","v","i","label","openOwnerModal","status","closeOwnerModal"],"sources":["E:/VCode/SHC社区管理系统/shc_community_manager_system/src/hook/real_estate/ownerInformation/addOwnerHook.js"],"sourcesContent":["// 添加业主\r\nimport { ref, inject } from 'vue'\r\nimport { useMessage } from 'naive-ui'\r\nimport QueryString from 'qs'\r\nimport axios from 'axios'\r\nimport { createId } from '../../../util/BaseUtil'\r\n\r\nexport default (refreshOwnerData) => {\r\n    // 接收全局变量\r\n    const global = inject(\"global\")\r\n    // 获取消息对象\r\n    const message = useMessage();\r\n\r\n    // 业主 模态框\r\n    const ownerStatus = ref(false); // false 添加 true 修改\r\n    const ownerFormRef = ref(null); // 业主 Form 引用\r\n    const showOwnerModal = ref(false) // 模态框是否打开\r\n\r\n    // 表单校验\r\n    const ownerRules = {\r\n        user: {\r\n            name: {\r\n                required: true,\r\n                message: \"请输入姓名\",\r\n                trigger: \"blur\"\r\n            },\r\n            gender: {\r\n                type: \"number\",\r\n                required: true,\r\n                message: \"请选择性别\",\r\n                trigger: \"blur\"\r\n            },\r\n            age: {\r\n                required: true,\r\n                message: \"请输入年龄\",\r\n                trigger: \"blur\"\r\n            },\r\n            phone: {\r\n                required: true,\r\n                message: \"请输入手机号码\",\r\n                trigger: \"blur\"\r\n            },\r\n        },\r\n    }\r\n    // 表单输入数据\r\n    const ownerformValue = ref({\r\n        user: {\r\n            name: \"\",\r\n            gender: null,\r\n            age: \"\",\r\n            idCard: \"\",\r\n            phone: \"\",\r\n            remark: \"\",\r\n            weCat: \"\",\r\n            isMember: 0\r\n        },\r\n    })\r\n\r\n    // 表单提交事件\r\n    const addownerSubmit = (e) => {\r\n        e.preventDefault();\r\n        ownerFormRef.value?.validate((errors) => {\r\n            if (!errors) {\r\n                // 校验通过\r\n                if (!ownerStatus.value) { // 添加\r\n                    addOwner()\r\n                } else { // 修改\r\n\r\n                }\r\n            } else {\r\n                // 校验不通过\r\n            }\r\n        });\r\n    }\r\n\r\n    // 业主添加加载\r\n    const addOwnerLoading = ref(false);\r\n    /**\r\n     * 添加业主\r\n     */\r\n    const addOwner = () => {\r\n        addOwnerLoading.value = true\r\n        ownerformValue.value.user.ownerNo = createId()\r\n        console.log(ownerformValue.value.user)\r\n        console.log(QueryString.stringify(ownerformValue.value.user));\r\n        axios({\r\n            method: 'post',\r\n            url: global.api + '/addOwner',\r\n            data: QueryString.stringify(ownerformValue.value.user)\r\n        }).then(res => {\r\n            console.log(res);\r\n            if (res.data.success) {\r\n                message.success(\"添加成功！\")\r\n                refreshOwnerData() // 刷新业主数据\r\n            } else {\r\n                message.warning(\"添加失败！\")\r\n            }\r\n        }).catch(err => {\r\n            message.error(\"添加业主出现异常！\" + err)\r\n        }).finally(() => {\r\n            addOwnerLoading.value = false\r\n        })\r\n    }\r\n\r\n    // 性别选择框数据\r\n    const ownerGenderOptions = ref(['男', '女'].map(\r\n        (v,i) => ({\r\n            label: v,\r\n            value: i\r\n        })\r\n    ))\r\n\r\n    /**\r\n     * 打开模态框\r\n     * @param {false 添加 true 修改} status\r\n     */\r\n    const openOwnerModal = (status) => {\r\n        showOwnerModal.value = true;\r\n        ownerStatus.value = status\r\n    }\r\n\r\n    /**\r\n     * 关闭模态框\r\n     */\r\n    const closeOwnerModal = () => {\r\n        showOwnerModal.value = false;\r\n    }\r\n\r\n    return {\r\n        ownerStatus, // 模态 添加 or 修改 框状态\r\n        ownerFormRef, // 业主 Form 引用\r\n        showOwnerModal, // 显示模态框\r\n        ownerRules, // 表单校验\r\n        ownerformValue, // 表单参数\r\n        ownerGenderOptions, // 性别选项数据\r\n        addOwnerLoading, // 业主添加加载\r\n        openOwnerModal, // 打开模态框\r\n        closeOwnerModal, // 关闭模态框\r\n        addownerSubmit, // 表单提交\r\n    }\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}